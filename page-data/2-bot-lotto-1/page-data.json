{"componentChunkName":"component---src-templates-blog-template-js","path":"/2-bot-lotto-1/","result":{"data":{"cur":{"id":"c67350c7-8c5b-5eba-82df-2dd3fd1d0af3","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>Github Action으로 로또 자동구매 해보자 🙌<br></p>\n<p><strong>🔵 순서</strong> <br></p>\n<ul>\n<li>1 로또 가입 및 예치금 충전</li>\n<li>2 github private 저장소를 생성</li>\n<li>3 github Action 코드 작성</li>\n<li>4 Python 자동구매 코드 작성</li>\n<li>5 github에 push</li>\n</ul>\n<hr>\n<h3 id=\"️-1-로또-가입-및-예치금-충전\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-1-%EB%A1%9C%EB%98%90-%EA%B0%80%EC%9E%85-%EB%B0%8F-%EC%98%88%EC%B9%98%EA%B8%88-%EC%B6%A9%EC%A0%84\" aria-label=\"️ 1 로또 가입 및 예치금 충전 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 1. 로또 가입 및 예치금 충전</h3>\n<blockquote>\n<p><a href=\"https://dhlottery.co.kr/\">https://dhlottery.co.kr/</a>\n회원가입 후 마이페이지 -> 예치금 -> 충전하기 1만원 충전</p>\n</blockquote>\n<hr>\n<h3 id=\"️-2-github-private-저장소를-생성\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-2-github-private-%EC%A0%80%EC%9E%A5%EC%86%8C%EB%A5%BC-%EC%83%9D%EC%84%B1\" aria-label=\"️ 2 github private 저장소를 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 2. github private 저장소를 생성</h3>\n<blockquote>\n<p><a href=\"https://github.com/\">https://github.com/</a> -> repository -> new<br>\nID,PW를 입력해야해서 <code class=\"language-text\">Private</code>모드로 설정해야 함<br></p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABkUlEQVQoz32S2W7bMBBF9ZQ29aLN1C6RlCVKluVEKmDHWdAAQfPW//+dW3AkO3Li9uFgiMHwcmYujePLG/r9M9puj5+HZxwef+Hp9R1FfYe55cF0QywdTTDgTs5jfmH7VKuj0XYPUO0eeXNAsXsk8uoOMVdgkYAXSYonvFiChZzy+qzjwgk+BM1VhJkV4LsZY+aksMKCurJZTK/rwi/Y3rmrk9AJ4/33H/CiQcJL+JHAfX9E1fRYqx0cL7ko/hfTx4yuO0KoFlm+gRtmCJsSdpZgHvuYO7rIx8xkhL5A0fQuuOhQqhay3CLNa2TrGmlZgZcbiHoLUTbI8pomEHoKWYHnG/h5DnudwOYxHJnCYtHHDnf9A1TTIZU1LdlaRbQ/jR75FKdnLbBkAZYsHBidJsFvMxs3PyzcLtzrBlxhuByM+OdvRIJBIqGaHjEvKWmtYuryGubI/8wxhLpH3fZIhILN9GjpSAI3yM65VZDB9VPis7PTzo20OkBqE4otFeuLA5wEWShIfHBZO8y+/L2py38BSzYaO7iAm2kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/825592b7e7c8c5ffabdeb180e2dc79cc/37523/2.png\"\n        srcset=\"/static/825592b7e7c8c5ffabdeb180e2dc79cc/e9ff0/2.png 180w,\n/static/825592b7e7c8c5ffabdeb180e2dc79cc/f21e7/2.png 360w,\n/static/825592b7e7c8c5ffabdeb180e2dc79cc/37523/2.png 720w,\n/static/825592b7e7c8c5ffabdeb180e2dc79cc/302a4/2.png 1080w,\n/static/825592b7e7c8c5ffabdeb180e2dc79cc/07a9c/2.png 1440w,\n/static/825592b7e7c8c5ffabdeb180e2dc79cc/f02b9/2.png 1554w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h3 id=\"️-3-github-action-코드-작성\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-github-action-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"️ 3 github action 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. github Action 코드 작성</h3>\n<blockquote>\n<p>workflows에 <code class=\"language-text\">action.yml</code>이 있어야만 Github Actions가 동작 합니다<br>\n<code class=\"language-text\">on</code> 을 <code class=\"language-text\">[push]</code>로 하면 즉시, <code class=\"language-text\">[schedule-cron]</code>으로 하면 매주 토요일 8:55분에 자동 구매</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/\n├── .github\n│   └── workflows\n│       └── action.yml\n├── README.md\n└── buy_lotto.py</code></pre></div>\n<blockquote>\n<p>action.yml 코드</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">name: Lotto Buy Bot <span class=\"token punctuation\">(</span>로또 구매봇<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#on: [push] # 주석을 풀면 바로 구매가 됨</span>\non:\n  schedule:\n    - cron: <span class=\"token string\">'55 23 * * 5'</span> <span class=\"token comment\"># UST 기준의 크론. UST 23:55 는 KST 08:55</span>\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        python-version: <span class=\"token punctuation\">[</span><span class=\"token number\">3.7</span><span class=\"token punctuation\">]</span>\n\n    steps:\n    - uses: actions/checkout@v2\n    - name: Set up python <span class=\"token variable\">${{ matrix.python-version }</span><span class=\"token punctuation\">}</span>\n      uses: actions/setup-python@v1\n      with:\n        python-version: <span class=\"token variable\">${{ matrix.python-version }</span><span class=\"token punctuation\">}</span>\n    \n    - name: Install python package\n      run: <span class=\"token operator\">|</span>        \n        pip <span class=\"token function\">install</span> selenium\n        pip <span class=\"token function\">install</span> requests        \n        pip <span class=\"token function\">install</span> twython\n        pip <span class=\"token function\">install</span> pillow    \n        pip <span class=\"token function\">install</span> gspread        \n        pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> google-api-python-client oauth2client\n        pip <span class=\"token function\">install</span> playwright\n        python <span class=\"token parameter variable\">-m</span> playwright <span class=\"token function\">install</span> <span class=\"token variable\">${{ matrix.browser-channel }</span><span class=\"token punctuation\">}</span> --with-deps\n    \n    - name: Install ubuntu package\n      run: <span class=\"token operator\">|</span>        \n        <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> fonts-unfonts-core\n        <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> fonts-unfonts-extra\n        <span class=\"token function\">wget</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-O</span> - https://dl-ssl.google.com/linux/linux_signing_key.pub <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span>        \n        <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> google-chrome-stable    \n        <span class=\"token function\">wget</span> https://chromedriver.storage.googleapis.com/100.0.4896.20/chromedriver_linux64.zip\n        <span class=\"token function\">unzip</span> ./chromedriver_linux64.zip           \n      \n    - name: Run<span class=\"token operator\">!</span>      \n      run: <span class=\"token operator\">|</span>        \n        python ./buy_lotto.py</code></pre></div>\n<hr>\n<h3 id=\"️-4-python-자동구매-코드-작성\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4-python-%EC%9E%90%EB%8F%99%EA%B5%AC%EB%A7%A4-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"️ 4 python 자동구매 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4. Python 자동구매 코드 작성</h3>\n<blockquote>\n<ul>\n<li><code class=\"language-text\">수정1</code>, <code class=\"language-text\">수정2</code>에 아이디,패스워드를 수정한다 <br></li>\n</ul>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> playwright<span class=\"token punctuation\">.</span>sync_api <span class=\"token keyword\">import</span> Playwright<span class=\"token punctuation\">,</span> sync_playwright\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token comment\"># 동행복권 아이디와 패스워드를 설정</span>\nUSER_ID <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;아이디>'</span> <span class=\"token comment\">#수정1</span>\nUSER_PW <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;비밀번호>'</span> <span class=\"token comment\">#수정2</span>\n\n<span class=\"token comment\"># 구매 개수를 설정</span>\nCOUNT <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span>playwright<span class=\"token punctuation\">:</span> Playwright<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># chrome 브라우저를 실행</span>\n    browser <span class=\"token operator\">=</span> playwright<span class=\"token punctuation\">.</span>chromium<span class=\"token punctuation\">.</span>launch<span class=\"token punctuation\">(</span>headless<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    context <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>new_context<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Open new page</span>\n    page <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span>new_page<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Go to https://dhlottery.co.kr/user.do?method=login</span>\n    page<span class=\"token punctuation\">.</span>goto<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://dhlottery.co.kr/user.do?method=login\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Click [placeholder=\"아이디\"]</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"[placeholder=\\\"아이디\\\"]\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Fill [placeholder=\"아이디\"]</span>\n    page<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">\"[placeholder=\\\"아이디\\\"]\"</span><span class=\"token punctuation\">,</span> USER_ID<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Press Tab</span>\n    page<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">\"[placeholder=\\\"아이디\\\"]\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tab\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Fill [placeholder=\"비밀번호\"]</span>\n    page<span class=\"token punctuation\">.</span>fill<span class=\"token punctuation\">(</span><span class=\"token string\">\"[placeholder=\\\"비밀번호\\\"]\"</span><span class=\"token punctuation\">,</span> USER_PW<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Press Tab</span>\n    page<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">\"[placeholder=\\\"비밀번호\\\"]\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tab\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Press Enter</span>\n    <span class=\"token comment\"># with page.expect_navigation(url=\"https://ol.dhlottery.co.kr/olotto/game/game645.do\"):</span>\n    <span class=\"token keyword\">with</span> page<span class=\"token punctuation\">.</span>expect_navigation<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        page<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">\"form[name=\\\"jform\\\"] >> text=로그인\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Enter\"</span><span class=\"token punctuation\">)</span>\n    \n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n    \n    page<span class=\"token punctuation\">.</span>goto<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span><span class=\"token string\">\"https://ol.dhlottery.co.kr/olotto/game/game645.do\"</span><span class=\"token punctuation\">)</span>    \n    <span class=\"token comment\"># \"비정상적인 방법으로 접속하였습니다. 정상적인 PC 환경에서 접속하여 주시기 바랍니다.\" 우회하기</span>\n    page<span class=\"token punctuation\">.</span>locator<span class=\"token punctuation\">(</span><span class=\"token string\">\"#popupLayerAlert\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_by_role<span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"확인\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Click text=자동번호발급</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"text=자동번호발급\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#page.click('#num2 >> text=자동번호발급')</span>\n\n    <span class=\"token comment\"># 구매할 개수를 선택</span>\n    <span class=\"token comment\"># Select 1</span>\n    page<span class=\"token punctuation\">.</span>select_option<span class=\"token punctuation\">(</span><span class=\"token string\">\"select\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>COUNT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Click text=확인</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"text=확인\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Click input:has-text(\"구매하기\")</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"input:has-text(\\\"구매하기\\\")\"</span><span class=\"token punctuation\">)</span>\n\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Click text=확인 취소 >> input[type=\"button\"]</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"text=확인 취소 >> input[type=\\\"button\\\"]\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Click input[name=\"closeLayer\"]</span>\n    page<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token string\">\"input[name=\\\"closeLayer\\\"]\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># assert page.url == \"https://el.dhlottery.co.kr/game/TotalGame.jsp?LottoId=LO40\"</span>\n\n    <span class=\"token comment\"># ---------------------</span>\n    context<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    browser<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">with</span> sync_playwright<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> playwright<span class=\"token punctuation\">:</span>\n    run<span class=\"token punctuation\">(</span>playwright<span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h3 id=\"️-5-github에-push\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-5-github%EC%97%90-push\" aria-label=\"️ 5 github에 push permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 5. github에 push</h3>\n<blockquote>\n<p>수정한 소스코드를 github에 push 한다<br></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"update\"</span>\n<span class=\"token function\">git</span> push origin main</code></pre></div>\n<blockquote>\n<p>github -> actions가 정상적으로 실행된걸 확인<br></p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACB0lEQVQoz2VTy5LTMBD0lQ2x45ckS7Lk9zsOG5aCLW6cOPH/f9PUjEn2wKFrpPGou0caB79+/8G43VF1C7ppRzffoP0AYVtI20KVHcdm3NEvr4xhveN6f+fc/vaTc+P1Dd38BYGpRig/Q5ZHVG6E0BUS6ZDIkiFtA9fOKJsZxg+w9QjfrSxM+QML74ModzibGyKzITQ7IjUglRafwgwvYYpTJKDcwOplMyGVDoqdtyxE+7KeWECYGkGYKCjjkeQFClsjyTWywsO35LqHcCv67R3SLSjKFsb3uGQathqQFx6pLLmWeAgBsZJilGqYakDhOmTKcdvkom43dP2OTHomIoI4t8iL6rmm+igtDsLr/QeW2xsSYdFNN0zbV3aobIPt9TuD7ixVjtsLkwKZ8rymulhYfL6ID4e6XjCuN7TTFZesQCIM4lyzALVIxIf64eAU5f+BCB8IpKnhuxllPaLqV7hm4g+5rtCMV85J0yDK9PHqwiIRJeOSk7jh+EBA/WvX8z1QMRUQIR1QtkcsSth64lmksSncwONByHUNYZpnJAT0UnW/MdlLmDHZ+SIRqQLlOmHZvx0uMs2tn2P5bJ9AOXL2WPPYUDFFJovlgURC+QbjeodrZvh24Qk4RRki2SHMPU5hxmfp56BpYUIieVwsET1iGCtcUv182XOiPsRi9Q+SjTyuivZ/AfghO2+ACf/jAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/7c8957eaee6ef8e5adad2908f993d58f/37523/3.png\"\n        srcset=\"/static/7c8957eaee6ef8e5adad2908f993d58f/e9ff0/3.png 180w,\n/static/7c8957eaee6ef8e5adad2908f993d58f/f21e7/3.png 360w,\n/static/7c8957eaee6ef8e5adad2908f993d58f/37523/3.png 720w,\n/static/7c8957eaee6ef8e5adad2908f993d58f/302a4/3.png 1080w,\n/static/7c8957eaee6ef8e5adad2908f993d58f/07a9c/3.png 1440w,\n/static/7c8957eaee6ef8e5adad2908f993d58f/61583/3.png 1616w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>마이페이지 -> 구매/당첨 -> 구매당첨내역 확인<br></p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABcklEQVQoz21SW0rDQBTNjtxDN+QeXIF/gj/uwBWoiP6IrehHq4IURNO0kqSZR+ad5MidNNrSXjjM694zZ87c5GeZ4uP9FaaWGEJKiWq9BmMMXdftoG3bCJqHEGCMgbU2QmuNZK0cvgqBjBtk3ELaBqqWyPM8JhC892iaJoKIKGikNZEPZzRPji+nGJ1NMDp/xtHpGBeTJWBrpNkSxmgopfrkTZGQNaqqivuH1CdVtUaWLpCXFXImoI2FFCIqVMZCKQ2tVCSwRmP+NsXtzTVms9mf0h1Co2oURYFaSmhVI3gfixmrIE0DYz1C8GhCAFMWT5mCCr3XbdvtqUysdVitVtDGRJPpWf8x+NWvFtzh5OoT80L3hMPBkE2Ezrn4m/RbJJmCPOKcbVT0P3qomC7cU0hE1Cbb7VCWZfSQc/4HwTm+0xSLLIsXUg6BzmgthIhjQm1BxdQaAyGp3oYnK5zDw/0dXsaP6NoWzvv4qqFlKI9s+wUq37S6qZ5zdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/6d6847c6edd23b6c78242e3f700f3cc7/37523/4.png\"\n        srcset=\"/static/6d6847c6edd23b6c78242e3f700f3cc7/e9ff0/4.png 180w,\n/static/6d6847c6edd23b6c78242e3f700f3cc7/f21e7/4.png 360w,\n/static/6d6847c6edd23b6c78242e3f700f3cc7/37523/4.png 720w,\n/static/6d6847c6edd23b6c78242e3f700f3cc7/302a4/4.png 1080w,\n/static/6d6847c6edd23b6c78242e3f700f3cc7/07a9c/4.png 1440w,\n/static/6d6847c6edd23b6c78242e3f700f3cc7/03692/4.png 2440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://velog.io/@king/githubactions-lotto\">https://velog.io/@king/githubactions-lotto</a><br></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-1-%EB%A1%9C%EB%98%90-%EA%B0%80%EC%9E%85-%EB%B0%8F-%EC%98%88%EC%B9%98%EA%B8%88-%EC%B6%A9%EC%A0%84\">⌨️ 1. 로또 가입 및 예치금 충전</a></li>\n<li><a href=\"#%EF%B8%8F-2-github-private-%EC%A0%80%EC%9E%A5%EC%86%8C%EB%A5%BC-%EC%83%9D%EC%84%B1\">⌨️ 2. github private 저장소를 생성</a></li>\n<li><a href=\"#%EF%B8%8F-3-github-action-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\">⌨️ 3. github Action 코드 작성</a></li>\n<li><a href=\"#%EF%B8%8F-4-python-%EC%9E%90%EB%8F%99%EA%B5%AC%EB%A7%A4-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\">⌨️ 4. Python 자동구매 코드 작성</a></li>\n<li><a href=\"#%EF%B8%8F-5-github%EC%97%90-push\">⌨️ 5. github에 push</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"👋 소개 Github Action으로 로또 자동구매 해보자 🙌 🔵 순서  1 로또 가입 및 예치금 충전 2 github private 저장소를 생성 3 github Action 코드 작성 4 Python 자동구매 코드 작성 5 github에 push ⌨️ 1. 로또 가입 및 예치금 충전 https://dhlottery.co.kr/\n회원가입 후 마이페이지 -> 예치금 -> 충전하기 1만원 충전 ⌨️ 2. github private 저장소를 생성 https://github.com/ -> repository -> new\nID,PW를 입력해야해서 모드로 설정해야 함  ⌨️ 3. github Action 코드 작성 workflows에 이 있어야만 Github Actions가 동작 합니다\n 을 로 하면 즉시, 으로 하면 매주 토요일 8:55분에 자동 구매 action.yml 코드 ⌨️ 4. Python 자동구매 코드 작성 , 에 아이디,패스워드를 수정한다  ⌨️ 5. github에 push 수정한 소…","frontmatter":{"date":"June 07, 2023","title":"[BOT] 매주 토요일 로또 자동 구매 - Github Action","categories":"BOT","author":"sb","emoji":"🤖"},"fields":{"slug":"/2-bot-lotto-1/"}},"next":{"id":"f389a948-49c3-5eca-972c-9293dc2af9dc","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>SSH-CERT 접근을 중앙에서 관리해 보자🙌<br></p>\n<p><strong>🔵 SSH-KEY 보다 SSH-CERT를 사용해야하는 4가지</strong> <br></p>\n<ul>\n<li>1 프로비저닝하거나 <code class=\"language-text\">프로비저닝 해제할 필요</code>가 없음</li>\n<li>2 인증서는 실제로 <code class=\"language-text\">단 한 줄</code>의 코드로 구현하기가 매우 간단함</li>\n<li>3 수명이 짧고 자체 파괴적이므로 자동으로 <code class=\"language-text\">기한 만료</code>됨</li>\n<li>4 key는 사용자가 생성 및 관리를 하지만 cert는 <code class=\"language-text\">CISO가 관리</code>를 할 수 있음</li>\n</ul>\n<p><strong>🔴 많은 기업들이 SSH-KEY를 사용하지 않는 이유 3가지</strong> <br></p>\n<ul>\n<li>1 <code class=\"language-text\">잘못된 PR</code> : 조직에서 인증서를 사용하도록 하는 데 충분한 추진력이 없음</li>\n<li>(Facebook, Uber, Netflix, Lyft 등이 SSH 인증서를 채택했지만 좋은 PR은 아직 나오지 않음)</li>\n<li>2 <code class=\"language-text\">PKI 지식 필요</code> : 이 작업을 수행하려면 약간의 PKI 지식이 필요</li>\n<li>3 <code class=\"language-text\">인프라 설정 필요</code> : SSH 인증서는 생각보다 어렵지 않지만 먼저 일부 구성을 수행해야 함</li>\n</ul>\n<p><strong>🟡 순서</strong> <br></p>\n<ul>\n<li>1 ssh-keygen으로 CA인증서 생성<code class=\"language-text\">(중앙서버)</code></li>\n<li>2 sshd_config 설정 및 키파일 전송<code class=\"language-text\">(목적지서버)</code></li>\n<li>3 ssh-keygen으로 sign받을 키페어 생성 <code class=\"language-text\">(출발지서버)</code></li>\n<li>4 CA인증서로 키페어 sign<code class=\"language-text\">(중앙서버)</code></li>\n<li>5 sign된 키로 목적지 서버에 ssh 접속<code class=\"language-text\">(출발지서버)</code></li>\n<li>6 ssh-cert 중앙관리 플로우</li>\n</ul>\n<hr>\n<h3 id=\"️-1-ssh-keygen으로-ca인증서-생성중앙서버\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-1-ssh-keygen%EC%9C%BC%EB%A1%9C-ca%EC%9D%B8%EC%A6%9D%EC%84%9C-%EC%83%9D%EC%84%B1%EC%A4%91%EC%95%99%EC%84%9C%EB%B2%84\" aria-label=\"️ 1 ssh keygen으로 ca인증서 생성중앙서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 1. ssh-keygen으로 CA인증서 생성(중앙서버)</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#passphrase는 없이 생성한다</span>\nssh-keygen <span class=\"token parameter variable\">-f</span> client_ca\n<span class=\"token comment\"># client_ca, client_ca.pub 파일이 생성된다</span></code></pre></div>\n<hr>\n<h3 id=\"️-2-sshd_config-설정-및-키파일-전송목적지서버\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-2-sshd_config-%EC%84%A4%EC%A0%95-%EB%B0%8F-%ED%82%A4%ED%8C%8C%EC%9D%BC-%EC%A0%84%EC%86%A1%EB%AA%A9%EC%A0%81%EC%A7%80%EC%84%9C%EB%B2%84\" aria-label=\"️ 2 sshd_config 설정 및 키파일 전송목적지서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 2. sshd_config 설정 및 키파일 전송(목적지서버)</h3>\n<blockquote>\n<p>/etc/ssh/sshd_conifg 설정 <br>\n설정 이후 sshd 서비스 재시작 필요<br>\n<code class=\"language-text\">이 키로부터 사인된 인증서로 접근하는 클라이언트라면 SSH 접근을 허용한다</code>라는 의미임 <br></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vi</span> /etc/ssh/sshd_config\n<span class=\"token comment\"># 중앙서버에서 생성한 client_ca.pub 파일을 목적지 서버로 가져와서 세팅한다</span>\nTrustedUserCAKeys /etc/ssh/client_ca.pub\n</code></pre></div>\n<hr>\n<h3 id=\"️-3-ssh-keygen으로-sign받을-키페어-생성-출발지서버\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-ssh-keygen%EC%9C%BC%EB%A1%9C-sign%EB%B0%9B%EC%9D%84-%ED%82%A4%ED%8E%98%EC%96%B4-%EC%83%9D%EC%84%B1-%EC%B6%9C%EB%B0%9C%EC%A7%80%EC%84%9C%EB%B2%84\" aria-label=\"️ 3 ssh keygen으로 sign받을 키페어 생성 출발지서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. ssh-keygen으로 sign받을 키페어 생성 (출발지서버)</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">#passphrase는 없이 생성한다</span>\nssh-keygen\n<span class=\"token comment\"># id_rsa, id_rsa.pub 파일이 생성된다</span></code></pre></div>\n<hr>\n<h3 id=\"️-4-ca인증서로-키페어-sign중앙서버\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4-ca%EC%9D%B8%EC%A6%9D%EC%84%9C%EB%A1%9C-%ED%82%A4%ED%8E%98%EC%96%B4-sign%EC%A4%91%EC%95%99%EC%84%9C%EB%B2%84\" aria-label=\"️ 4 ca인증서로 키페어 sign중앙서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4. CA인증서로 키페어 sign(중앙서버)</h3>\n<blockquote>\n<p>출발지 서버에서 id_rsa.pub 파일을 가져온다 <br>\n기존에 만든 client_ca인증서로 sign을 한다 <br></p>\n<ul>\n<li>옵션 -n : 계정명 <br></li>\n<li>옵션 -V : 사용기간 <br></li>\n</ul>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ssh-keygen <span class=\"token parameter variable\">-s</span> client_ca <span class=\"token parameter variable\">-I</span> user_identifier <span class=\"token parameter variable\">-n</span> root <span class=\"token parameter variable\">-V</span> +5m id_rsa.pub\n<span class=\"token comment\">#  id_rsa-cert.pub 파일이 생성된다</span></code></pre></div>\n<hr>\n<h3 id=\"️-5-sign된-키로-목적지-서버에-ssh-접속출발지서버\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-5-sign%EB%90%9C-%ED%82%A4%EB%A1%9C-%EB%AA%A9%EC%A0%81%EC%A7%80-%EC%84%9C%EB%B2%84%EC%97%90-ssh-%EC%A0%91%EC%86%8D%EC%B6%9C%EB%B0%9C%EC%A7%80%EC%84%9C%EB%B2%84\" aria-label=\"️ 5 sign된 키로 목적지 서버에 ssh 접속출발지서버 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 5. sign된 키로 목적지 서버에 ssh 접속(출발지서버)</h3>\n<blockquote>\n<p>중앙서버에서 발급한 id_rsa-cert.pub키를 ~/.ssh/id_rsa-cert.pub 로 위치시킨다<br></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> 계정명@목적지서버\n<span class=\"token comment\">#접속성공</span></code></pre></div>\n<hr>\n<h3 id=\"️-6-ssh-cert-중앙관리-플로우\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-6-ssh-cert-%EC%A4%91%EC%95%99%EA%B4%80%EB%A6%AC-%ED%94%8C%EB%A1%9C%EC%9A%B0\" aria-label=\"️ 6 ssh cert 중앙관리 플로우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 6. ssh-cert 중앙관리 플로우</h3>\n<blockquote>\n<p>보안 담당자는 는 미리 ssh-cert 중앙관리 서버에 <code class=\"language-text\">CA인증서</code>를 생성해둔다 <br>\n인프라 담당자는 미리 모든 서버에 <code class=\"language-text\">CA키</code>, <code class=\"language-text\">TrustedUserCAKeys</code> 세팅해 논다<br>\n사용자는 ssh접속이 필요할경우 <code class=\"language-text\">키페어</code>를 생성해 <code class=\"language-text\">signing요청</code>을 하고 ssh접속을 한다<br></p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACJklEQVQ4y5WSTW8SURSG+dtuTLrrUreaaFzUmmhcqKuakNrWWhNrm1ILDDCAQOcLZphvmK/H3EuGYjuN9SQnd+C+ec57zrk1KiJJEmzb4b4Q97OZvf5dFMX6u5ZlGcvlUorEuVgsUHoj9upHmJYlRVEU4XmePKGg2x9TPzhhNJ7cBfq+z/X1NZZloes6k8mY+tEZj7a2+Xl+LtQYhiE1wnUcRxyeNNjafsLh8TcJyfP8BljV0sVVl2cvd9B0vbJldajx/NUu3Z66BgqXImvlh8iyUlHcVBT/bWbZXpIs77S7drgJFSFmGccLigp3q8IFYRiui4g9iJQO7wOKLO9Mw2DQ72NZZoklCALm87mcrWmacs5isbXblkWIaqKlmZ8xtBJ6WoQyDuQ5nKaYbio3Xrr7a4bls7BtW1YU6dg2fhChmjltLefXMOC8M+VqFKPoOR09xfPDyoVJoHh7juPgui6u6zG1LOauj2okNCdLvp4qvH7zlv3vTbomtCcRcy/g9rjWW66KMIpp/g5oDAI+fv7B46cv2D1ooWgZzVFIEC0etuWVoCDLC1Qzo2sUXA5DduoN3h+1OW1POetMSdL8fuDmkygFaZbLlltaxkCL6Q0cmqOIi77H5cBlmWT/Bm4KBLCnJwxmsHfS5sOXT7SGDh1j5fxBDm8Du3qCauTsKy7vTlUaik5Ly+loyf8BV5oCy03pGQnjaYY2y+mbiRyDMU/lfVEB/AMces9LEraQVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/a6923deb2064110af7a86628da5c0531/37523/1.png\"\n        srcset=\"/static/a6923deb2064110af7a86628da5c0531/e9ff0/1.png 180w,\n/static/a6923deb2064110af7a86628da5c0531/f21e7/1.png 360w,\n/static/a6923deb2064110af7a86628da5c0531/37523/1.png 720w,\n/static/a6923deb2064110af7a86628da5c0531/302a4/1.png 1080w,\n/static/a6923deb2064110af7a86628da5c0531/07a9c/1.png 1440w,\n/static/a6923deb2064110af7a86628da5c0531/bd9eb/1.png 1442w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22\">https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22</a><br>\n<a href=\"https://blog.naver.com/alice_k106/221803861645\">https://blog.naver.com/alice_k106/221803861645</a></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-1-ssh-keygen%EC%9C%BC%EB%A1%9C-ca%EC%9D%B8%EC%A6%9D%EC%84%9C-%EC%83%9D%EC%84%B1%EC%A4%91%EC%95%99%EC%84%9C%EB%B2%84\">⌨️ 1. ssh-keygen으로 CA인증서 생성(중앙서버)</a></li>\n<li><a href=\"#%EF%B8%8F-2-sshd_config-%EC%84%A4%EC%A0%95-%EB%B0%8F-%ED%82%A4%ED%8C%8C%EC%9D%BC-%EC%A0%84%EC%86%A1%EB%AA%A9%EC%A0%81%EC%A7%80%EC%84%9C%EB%B2%84\">⌨️ 2. sshd_config 설정 및 키파일 전송(목적지서버)</a></li>\n<li><a href=\"#%EF%B8%8F-3-ssh-keygen%EC%9C%BC%EB%A1%9C-sign%EB%B0%9B%EC%9D%84-%ED%82%A4%ED%8E%98%EC%96%B4-%EC%83%9D%EC%84%B1-%EC%B6%9C%EB%B0%9C%EC%A7%80%EC%84%9C%EB%B2%84\">⌨️ 3. ssh-keygen으로 sign받을 키페어 생성 (출발지서버)</a></li>\n<li><a href=\"#%EF%B8%8F-4-ca%EC%9D%B8%EC%A6%9D%EC%84%9C%EB%A1%9C-%ED%82%A4%ED%8E%98%EC%96%B4-sign%EC%A4%91%EC%95%99%EC%84%9C%EB%B2%84\">⌨️ 4. CA인증서로 키페어 sign(중앙서버)</a></li>\n<li><a href=\"#%EF%B8%8F-5-sign%EB%90%9C-%ED%82%A4%EB%A1%9C-%EB%AA%A9%EC%A0%81%EC%A7%80-%EC%84%9C%EB%B2%84%EC%97%90-ssh-%EC%A0%91%EC%86%8D%EC%B6%9C%EB%B0%9C%EC%A7%80%EC%84%9C%EB%B2%84\">⌨️ 5. sign된 키로 목적지 서버에 ssh 접속(출발지서버)</a></li>\n<li><a href=\"#%EF%B8%8F-6-ssh-cert-%EC%A4%91%EC%95%99%EA%B4%80%EB%A6%AC-%ED%94%8C%EB%A1%9C%EC%9A%B0\">⌨️ 6. ssh-cert 중앙관리 플로우</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 06, 2023","title":"[보안] SSH 접근 중앙관리 - SSH-Cert 관리 (3)","categories":"보안","author":"sb","emoji":"🔐"},"fields":{"slug":"/5-security-ssh-3/"}},"prev":{"id":"ba1f5c3e-a006-5a3d-bc21-e21dfabf162d","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>ATT&#x26;CK 리눅스 공격 기법에 대해 알아보자🙌<br></p>\n<hr>\n<h3 id=\"-1-attck란-br\" style=\"position:relative;\"><a href=\"#-1-attck%EB%9E%80-br\" aria-label=\" 1 attck란 br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🔴 1. ATT&#x26;CK란 <br></h3>\n<p>ATT&#x26;CK는 (미터)라는 조직이 개발한 <code class=\"language-text\">공격 기술</code>과 <code class=\"language-text\">방어 기술</code>에 대한 <code class=\"language-text\">프레임워크</code>입니다. “ATT&#x26;CK”는 “Adversarial Tactics, Techniques, and Common Knowledge”의 약자로,공격자의 전술, 기술, 공통 지식을 다루고 이를 통해 보안 전문가와 조직은 공격자가 사용하는 다양한 전술과 기술을 이해하고, 그에 대응하는 <code class=\"language-text\">방어 전략을 수립</code>할 수 있습니다.<br></p>\n<p><strong>ATT&#x26;CK 프레임워크</strong>는 <code class=\"language-text\">전술(Tactics)</code>과 <code class=\"language-text\">기술(Techniques)</code>로 구성됩니다. 전술은 공격자가 공격을 수행하는 고수준의 목표를 의미하며, 기술은 실제로 사용되는 공격 기법과 방법을 설명합니다. 각 전술과 기술은 공격자의 행위를 카테고리화하고 문서화하여 보안 커뮤니티에 제공됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADiklEQVQ4y41UbUxbVRi+GmNqnMkSNftjdIkmRJMlxh+6bBpGJ2y0o3QICi0UJQpsgAtZMqBjQEuY0vXD7l7SdrRFR0fLvb3nnnPuPad37VC3+JEsW+b2A1FnIjFGnUuGSBBNSE17Wyj6x/ee3I9z3ue8532f570M2mqw+IIxJoRQStPpNIRQW4JFH20wuQ+IICzctAfCmBcE+8khk8nc09OVSqUKS6jgBCGUICwBFw0AoKqqfXCo0lD30u49DMM4RsdUNSVJ0v8CpzOZysoq3bbHjlqeadTf32GrIlQFEpDgFmNKN8sjpZSqerw+ne4hhmEefOC+toPMgfLneAHSFMUYFx1zIZmNPPO75Esly9WHzAzDWK1Noah4NWE80ahrsHTOzMzEYhewLJeCkVYJhBAAUjqdcZ1xP7vrhapq0+8rq9ls9ofFH/0s++iOJywt74iiiDaDwyIYQkopy00crrea6hp1D29/6ukyde7zu0srK2vrKH3l5XI9NxFIUVqSthZ5g0AIGy0tr7xqGveyH8Vmb87f/unOvd+WVniouJyDmbmPC9mhjWOXkA6xfClDpDh3Y37xr2z2ztLqz/dWb97+1cVORZxvJWPBLc6oBIwQFET6Rcrz51fmWGh4ekaS6UWCQYQbA57mNVRxNWAWRIrxvxSWH5IEMElH486Fi2XLl568FS77LvbiPLfrbnDnWmTH9+wjfrfeH4sQLEuFwxfliTACghS6HD31mavJY/NG9v5yeWd2bvv69LYb7OOj7z1vGK3ZPXx40O+UobxVJAjHE4lkQjwte3q/HnAsuFrBYEOgeSRUPsDtM3qaKjytNWPW8ZA7EZ8VAUiKIkJ4s9oI46mpD0eco+39R1rPH7UvOnq/HGoW+oyhzuqgpcHZ8uknV9b/Xp/l+YVvvkVYngyHZVnOgRVFCQSDxpra+rra1tfNNbXNtnC7jbSbuDf0DpPB/lpnb5frfde169eWl/+IxxM97x4LhyM5sKwoXp/fYDy0r2L/nr3l+gOG0+Nn3G5vx8nu+uNWW3db34k+n8/3gd8/POLo7x/o6u5huQmtZjnwgP3Um20dFfsPvt1+hOcFjPEsz0cno2e9Zzk/GzoXOj89raU2GQ4DAAilmzwTQoKhc9xEgBACIRRzvSeJkiiAJJ/kk6IowdyFECJ5eQKtsYtUQUKpoigg1+8QIvTff1NBC0WGtcl/APt23iQWmwkVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/04be1306bc101e5df67280573092fab4/01e7c/1.png\"\n        srcset=\"/static/04be1306bc101e5df67280573092fab4/e9ff0/1.png 180w,\n/static/04be1306bc101e5df67280573092fab4/f21e7/1.png 360w,\n/static/04be1306bc101e5df67280573092fab4/01e7c/1.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"-2-12개-tactics-전술br\" style=\"position:relative;\"><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\" aria-label=\" 2 12개 tactics 전술br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🟡 2. 12개 Tactics 전술<br></h2>\n<ul>\n<li><code class=\"language-text\">Initial Access</code>: 공격자가 시스템 또는 네트워크에 처음으로 접근하기 위해 사용하는 기법 전술</li>\n<li><code class=\"language-text\">Execution</code>: 공격자가 악성 코드 또는 악성 스크립트를 실행하여 시스템 내에서 명령을 실행하는 전술</li>\n<li><code class=\"language-text\">Persistence</code>: 공격자가 시스템에 대한 지속적인 액세스를 유지하기 위해 사용하는 기법을 포함한 전술입니다.</li>\n<li><code class=\"language-text\">Privilege Escalation</code>: 공격자가 권한 상승을 시도하여 시스템 내에서 더 높은 수준의 권한을 획득하는 전술입니다.</li>\n<li><code class=\"language-text\">Defense Evasion</code>: 공격자가 탐지 및 방어 기술을 피하고 자신의 활동을 감추는 기법을 사용하는 전술입니다.</li>\n<li><code class=\"language-text\">Credential Access</code>: 공격자가 인증 정보를 획득하여 시스템 또는 네트워크에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Discovery</code>: 공격자가 대상 시스템 및 네트워크를 조사하여 정보를 수집하는 전술입니다.</li>\n<li><code class=\"language-text\">Lateral Movement</code>: 공격자가 시스템 및 네트워크 내에서 이동하여 다른 시스템에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Collection</code>: 공격자가 획득한 정보를 수집하고 추출하는 전술입니다.</li>\n<li><code class=\"language-text\">Exfiltration</code>: 공격자가 훔친 데이터를 시스템 또는 네트워크 외부로 전송하는 전술입니다.</li>\n<li><code class=\"language-text\">Command and Control</code>: 공격자가 원격 명령 및 제어 인프라를 구축하고 시스템과 통신하는 전술입니다.</li>\n<li><code class=\"language-text\">Impact</code>: 공격자가 시스템 또는 네트워크에 직접적인 피해를 입히는 전술입니다.</li>\n</ul>\n<hr>\n<h3 id=\"️-3-initial-access\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-initial-access\" aria-label=\"️ 3 initial access permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. Initial Access</h3>\n<p>T1189: “Drive-by Compromise”</p>\n<blockquote>\n<p>Drive-by Compromise는 공격자가 사용자를 유해한 웹사이트로 유도하거나, 이미 침해된 웹사이트를 이용해 사용자의 시스템을 감염시키는 기법입니다. 이런 공격을 방어하기 위한 auditd 규칙을 작성하는 것은 쉽지 않습니다. 대부분의 웹 브라우저 활동은 사용자 공간에서 발생하며, 이는 auditd가 직접 모니터링할 수 있는 범위를 벗어납니다. 그래서 웹 브라우징 활동을 보호하기 위해선 보다 종합적인 접근 방법이 필요합니다.</p>\n</blockquote>\n<p>T1190: “Exploit Public-Facing Application”</p>\n<blockquote>\n<p>이 공격 기법은 공격자가 공개적으로 접근 가능한 애플리케이션을 악용하는 것을 의미합니다. 이러한 공격을 방어하기 위한 auditd 규칙은 대상 애플리케이션에 따라 다릅니다. 예를 들어, 웹 서버 소프트웨어인 Apache에 대한 auditd 규칙은 아래와 같이 설정될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/httpd <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-k</span> public_facing_exploit</code></pre></div>\n<p>T1133: “External Remote Services”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템에 원격으로 접속하기 위해 외부의 원격 서비스를 사용하는 것을 의미합니다. 이런 공격을 감지하기 위한 auditd 규칙 중 하나는 ssh 접근을 모니터링하는 것입니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/sshd <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-k</span> external_remote_service</code></pre></div>\n<p>T1200: “Hardware Additions”</p>\n<blockquote>\n<p>이 기법은 공격자가 물리적 하드웨어를 추가하여 시스템을 공격하는 것을 나타냅니다. 이를 감지하기 위해 USB 장치 연결에 대한 auditd 규칙을 만들 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/ <span class=\"token parameter variable\">-p</span> rwa <span class=\"token parameter variable\">-k</span> hardware_additions</code></pre></div>\n<p>T1566: “Phishing”</p>\n<blockquote>\n<p>Phishing은 공격자가 사기성 이메일, 웹사이트 등을 통해 사용자의 개인 정보나 신용 정보를 탈취하는 공격 기법입니다. auditd를 이용해 이를 직접적으로 감지하는 것은 어렵습니다. 이메일 클라이언트나 웹 브라우저와 같은 사용자 공간의 활동은 auditd가 모니터링 범위에서 벗어나기 때문입니다.</p>\n</blockquote>\n<p>T1195: “Supply Chain Compromise”</p>\n<blockquote>\n<p>이 기법은 공급망 침해를 나타냅니다. 공격자는 공급망의 일부인 소프트웨어 개발 환경이나 업데이트 시스템 등을 타깃으로 합니다. auditd 규칙으로 이런 공격을 완전히 차단하기는 어렵지만, 소프트웨어 설치 및 업데이트에 관련된 실행 파일을 모니터링하는 것이 도움이 될 수 있습니다.</p>\n</blockquote>\n<blockquote>\n<p>예를 들어, dpkg (Debian 패키지 시스템)을 모니터링하는 auditd 규칙은 다음과 같이 설정될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/dpkg <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-k</span> supply_chain_compromise</code></pre></div>\n<p>T1199: “Trusted Relationship”</p>\n<blockquote>\n<p>이 기법은 신뢰 관계를 악용하는 공격을 나타냅니다. 공격자는 이미 타깃 네트워크 내부에 액세스한 시스템을 통해 다른 시스템에 공격을 확장합니다. 이를 방지하는 구체적인 auditd 규칙을 제시하기는 어렵습니다. 신뢰 관계를 악용하는 공격은 네트워크 내부에서 일어나기 때문에 이런 동작을 감지하기 위해서는 보다 복잡한 네트워크 모니터링이 필요합니다.</p>\n</blockquote>\n<p>T1078: “Valid Accounts”</p>\n<blockquote>\n<p>이 기법은 유효한 계정을 이용하는 공격을 나타냅니다. 공격자는 탈취하거나 악용할 수 있는 유효한 계정을 찾아 시스템 또는 서비스에 액세스합니다. 이런 공격을 감지하기 위한 auditd 규칙 중 하나는 /etc/passwd와 /etc/shadow 파일에 대한 변경을 모니터링하는 것입니다. 이 파일들에는 시스템의 사용자 계정과 암호화된 비밀번호가 저장되어 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">\n<span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> valid_accounts\n<span class=\"token parameter variable\">-w</span> /etc/shadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> valid_accounts</code></pre></div>\n<blockquote>\n<p>이 규칙들은 /etc/passwd와 /etc/shadow 파일에 대한 write (w)와 attribute change (a)를 모니터링하며, 이벤트를 ‘valid_accounts’ 키와 함께 로깅합니다</p>\n</blockquote>\n<h3 id=\"️-4execution\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4execution\" aria-label=\"️ 4execution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4.Execution</h3>\n<p>T1059: “Command and Scripting Interpreter: PowerShell”</p>\n<p>PowerShell은 시스템 관리와 자동화를 위한 강력한 명령어 셸과 스크립팅 언어 환경입니다. 이는 공격자가 시스템에 액세스하고, 내부에서 작업을 수행하기 위한 방법으로도 사용될 수 있습니다. 이런 활동을 감지하기 위한 auditd 규칙 중 하나는 PowerShell 실행을 모니터링하는 것입니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/powershell <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-k</span> powershell_execution</code></pre></div>\n<p>T1203: “Exploit for Client Execution”</p>\n<blockquote>\n<p>이 기법은 공격자가 클라이언트 소프트웨어 취약점을 악용하여 코드를 실행하는 것을 나타냅니다. 이를 방어하기 위한 특정 auditd 규칙을 설정하기는 어렵습니다. 이는 대상 클라이언트 소프트웨어와 그 취약점에 따라 달라지기 때문입니다.</p>\n</blockquote>\n<p>T1559: “Inter-Process Communication: Dynamic Data Exchange”</p>\n<blockquote>\n<p>Dynamic Data Exchange (DDE)는 프로세스 간에 데이터를 공유하고 통신하는 기법입니다. DDE는 윈도우 환경에서 주로 사용되는데, 이를 감지하기 위한 Linux의 auditd 규칙을 제시하기는 어렵습니다.</p>\n</blockquote>\n<p>T1106: “Native API”</p>\n<blockquote>\n<p>Native API는 운영 체제에서 제공하는 API를 직접 사용하는 기법을 나타냅니다. 이를 감지하는 구체적인 auditd 규칙을 작성하기는 어렵습니다. Native API는 매우 광범위하며, 일반적인 시스템 작업에도 사용됩니다.</p>\n</blockquote>\n<p>T1053: “Scheduled Task/Job”</p>\n<blockquote>\n<p>공격자는 계획된 작업 또는 잡을 사용하여 유해한 프로그램을 실행할 수 있습니다. 이를 감지하기 위한 auditd 규칙 중 하나는 cron 작업을 모니터링하는 것입니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /var/spool/cron <span class=\"token parameter variable\">-k</span> scheduled_task</code></pre></div>\n<p>T1072: “Software Deployment Tools”</p>\n<blockquote>\n<p>공격자는 소프트웨어 배포 도구를 악용하여 시스템에 악성 코드를 배포할 수 있습니다. 이를 감지하기 위한 auditd 규칙은 대상 소프트웨어 배포 도구에 따라 다르게 설정됩니다.</p>\n</blockquote>\n<p>T1569: “System Services”</p>\n<blockquote>\n<p>공격자는 시스템 서비스를 악용하여 지속성을 확보하거나 권한 상승을 시도할 수 있습니다. 이를 감지하기 위한 auditd 규칙은 대상 시스템 서비스에 따라 다르게 설정됩니다.</p>\n</blockquote>\n<p>T1204: “User Execution”</p>\n<blockquote>\n<p>사용자 실행은 공격자가 사용자에게 파일이나 링크를 클릭하도록 유도하는 기법을 나타냅니다. 이를 방어하기 위한 특정 auditd 규칙을 설정하기는 어렵습니다. 이는 사용자의 입력에 의존하는 작업이며 auditd의 감시 범위를 벗어나는 경우가 많습니다.</p>\n</blockquote>\n<hr>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22\">https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22</a><br>\n<a href=\"https://blog.naver.com/alice_k106/221803861645\">https://blog.naver.com/alice_k106/221803861645</a></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#-1-attck%EB%9E%80-br\">🔴 1. ATT&#x26;CK란 <br></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\">🟡 2. 12개 Tactics 전술<br></a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-3-initial-access\">⌨️ 3. Initial Access</a></li>\n<li><a href=\"#%EF%B8%8F-4execution\">⌨️ 4.Execution</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 13, 2023","title":"[보안]  ATT&CK - Linux 공격기법 정리 (1)","categories":"보안","author":"sb","emoji":"🔐"},"fields":{"slug":"/5-security-mitre-1/"}},"site":{"siteMetadata":{"siteUrl":"https://sbbb.me","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/2-bot-lotto-1/","nextSlug":"/5-security-ssh-3/","prevSlug":"/5-security-mitre-1/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}