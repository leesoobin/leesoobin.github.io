{"componentChunkName":"component---src-templates-blog-template-js","path":"/5-security-mitre-3","result":{"data":{"cur":{"id":"358e1a0c-ae93-5fb1-8248-3c2cfdef10b7","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>ATT&#x26;CK 리눅스 공격 기법에 대해 알아보자🙌<br></p>\n<hr>\n<h3 id=\"-1-attck란-br\" style=\"position:relative;\"><a href=\"#-1-attck%EB%9E%80-br\" aria-label=\" 1 attck란 br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🔴 1. ATT&#x26;CK란 <br></h3>\n<p>ATT&#x26;CK는 (미터)라는 조직이 개발한 <code class=\"language-text\">공격 기술</code>과 <code class=\"language-text\">방어 기술</code>에 대한 <code class=\"language-text\">프레임워크</code>입니다. “ATT&#x26;CK”는 “Adversarial Tactics, Techniques, and Common Knowledge”의 약자로,공격자의 전술, 기술, 공통 지식을 다루고 이를 통해 보안 전문가와 조직은 공격자가 사용하는 다양한 전술과 기술을 이해하고, 그에 대응하는 <code class=\"language-text\">방어 전략을 수립</code>할 수 있습니다.<br></p>\n<p><strong>ATT&#x26;CK 프레임워크</strong>는 <code class=\"language-text\">전술(Tactics)</code>과 <code class=\"language-text\">기술(Techniques)</code>로 구성됩니다. 전술은 공격자가 공격을 수행하는 고수준의 목표를 의미하며, 기술은 실제로 사용되는 공격 기법과 방법을 설명합니다. 각 전술과 기술은 공격자의 행위를 카테고리화하고 문서화하여 보안 커뮤니티에 제공됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADiklEQVQ4y41UbUxbVRi+GmNqnMkSNftjdIkmRJMlxh+6bBpGJ2y0o3QICi0UJQpsgAtZMqBjQEuY0vXD7l7SdrRFR0fLvb3nnnPuPad37VC3+JEsW+b2A1FnIjFGnUuGSBBNSE17Wyj6x/ee3I9z3ue8532f570M2mqw+IIxJoRQStPpNIRQW4JFH20wuQ+IICzctAfCmBcE+8khk8nc09OVSqUKS6jgBCGUICwBFw0AoKqqfXCo0lD30u49DMM4RsdUNSVJ0v8CpzOZysoq3bbHjlqeadTf32GrIlQFEpDgFmNKN8sjpZSqerw+ne4hhmEefOC+toPMgfLneAHSFMUYFx1zIZmNPPO75Esly9WHzAzDWK1Noah4NWE80ahrsHTOzMzEYhewLJeCkVYJhBAAUjqdcZ1xP7vrhapq0+8rq9ls9ofFH/0s++iOJywt74iiiDaDwyIYQkopy00crrea6hp1D29/6ukyde7zu0srK2vrKH3l5XI9NxFIUVqSthZ5g0AIGy0tr7xqGveyH8Vmb87f/unOvd+WVniouJyDmbmPC9mhjWOXkA6xfClDpDh3Y37xr2z2ztLqz/dWb97+1cVORZxvJWPBLc6oBIwQFET6Rcrz51fmWGh4ekaS6UWCQYQbA57mNVRxNWAWRIrxvxSWH5IEMElH486Fi2XLl568FS77LvbiPLfrbnDnWmTH9+wjfrfeH4sQLEuFwxfliTACghS6HD31mavJY/NG9v5yeWd2bvv69LYb7OOj7z1vGK3ZPXx40O+UobxVJAjHE4lkQjwte3q/HnAsuFrBYEOgeSRUPsDtM3qaKjytNWPW8ZA7EZ8VAUiKIkJ4s9oI46mpD0eco+39R1rPH7UvOnq/HGoW+oyhzuqgpcHZ8uknV9b/Xp/l+YVvvkVYngyHZVnOgRVFCQSDxpra+rra1tfNNbXNtnC7jbSbuDf0DpPB/lpnb5frfde169eWl/+IxxM97x4LhyM5sKwoXp/fYDy0r2L/nr3l+gOG0+Nn3G5vx8nu+uNWW3db34k+n8/3gd8/POLo7x/o6u5huQmtZjnwgP3Um20dFfsPvt1+hOcFjPEsz0cno2e9Zzk/GzoXOj89raU2GQ4DAAilmzwTQoKhc9xEgBACIRRzvSeJkiiAJJ/kk6IowdyFECJ5eQKtsYtUQUKpoigg1+8QIvTff1NBC0WGtcl/APt23iQWmwkVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/04be1306bc101e5df67280573092fab4/01e7c/1.png\"\n        srcset=\"/static/04be1306bc101e5df67280573092fab4/e9ff0/1.png 180w,\n/static/04be1306bc101e5df67280573092fab4/f21e7/1.png 360w,\n/static/04be1306bc101e5df67280573092fab4/01e7c/1.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"-2-12개-tactics-전술br\" style=\"position:relative;\"><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\" aria-label=\" 2 12개 tactics 전술br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🟡 2. 12개 Tactics 전술<br></h2>\n<ul>\n<li><code class=\"language-text\">Initial Access</code>: 공격자가 시스템 또는 네트워크에 처음으로 접근하기 위해 사용하는 기법 전술</li>\n<li><code class=\"language-text\">Execution</code>: 공격자가 악성 코드 또는 악성 스크립트를 실행하여 시스템 내에서 명령을 실행하는 전술</li>\n<li><code class=\"language-text\">Persistence</code>: 공격자가 시스템에 대한 지속적인 액세스를 유지하기 위해 사용하는 기법을 포함한 전술입니다.</li>\n<li><code class=\"language-text\">Privilege Escalation</code>: 공격자가 권한 상승을 시도하여 시스템 내에서 더 높은 수준의 권한을 획득하는 전술입니다.</li>\n<li><code class=\"language-text\">Defense Evasion</code>: 공격자가 탐지 및 방어 기술을 피하고 자신의 활동을 감추는 기법을 사용하는 전술입니다.</li>\n<li><code class=\"language-text\">Credential Access</code>: 공격자가 인증 정보를 획득하여 시스템 또는 네트워크에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Discovery</code>: 공격자가 대상 시스템 및 네트워크를 조사하여 정보를 수집하는 전술입니다.</li>\n<li><code class=\"language-text\">Lateral Movement</code>: 공격자가 시스템 및 네트워크 내에서 이동하여 다른 시스템에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Collection</code>: 공격자가 획득한 정보를 수집하고 추출하는 전술입니다.</li>\n<li><code class=\"language-text\">Exfiltration</code>: 공격자가 훔친 데이터를 시스템 또는 네트워크 외부로 전송하는 전술입니다.</li>\n<li><code class=\"language-text\">Command and Control</code>: 공격자가 원격 명령 및 제어 인프라를 구축하고 시스템과 통신하는 전술입니다.</li>\n<li><code class=\"language-text\">Impact</code>: 공격자가 시스템 또는 네트워크에 직접적인 피해를 입히는 전술입니다.</li>\n</ul>\n<hr>\n<h3 id=\"️-3-credential-access\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-credential-access\" aria-label=\"️ 3 credential access permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. Credential Access</h3>\n<p>T1557: Man-in-the-Middle:</p>\n<blockquote>\n<p>이 기법은 공격자가 통신 채널 중간에서 트래픽을 도청, 변조하거나 리다이렉트하는 것입니다. 이는 주로 네트워크 레벨에서 발생하므로 auditd로 직접적으로 감지하는 것은 어렵습니다. 그러나 SSL/TLS를 변조하는 데 사용될 수 있는 툴에 대한 접근을 감지할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/ssldump <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> mitm\n<span class=\"token parameter variable\">-w</span> /usr/bin/tcpdump <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> mitm\n</code></pre></div>\n<p>T1110: Brute Force</p>\n<blockquote>\n<p>이 기법은 공격자가 계정 접근을 시도하며 암호를 맞추려고 하는 것입니다. 이를 감지하기 위해 계정 로그인 관련 이벤트를 모니터링 할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/log/auth.log <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> brute_force\n<span class=\"token parameter variable\">-w</span> /var/log/secure <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> brute_force</code></pre></div>\n<p>T1555: Credentials from Password Stores:</p>\n<blockquote>\n<p>기법은 공격자가 암호 저장소로부터 사용자의 인증 정보를 탈취하는 것입니다. 이를 감지하기 위해 관련 시스템 호출을 모니터링 할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> <span class=\"token function\">open</span> <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">exit</span><span class=\"token operator\">=</span>-EACCES <span class=\"token parameter variable\">-k</span> password_store_access\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> <span class=\"token function\">open</span> <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">exit</span><span class=\"token operator\">=</span>-EPERM <span class=\"token parameter variable\">-k</span> password_store_access</code></pre></div>\n<p>T1212: Exploitation for Credential Access:</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 취약점을 이용하여 인증 정보를 획득하는 것입니다. 이를 직접 감지하는 것은 매우 어렵지만, 보통 취약점을 이용하기 위해 특정 프로그램을 실행하게 되므로, 이러한 실행을 감지하는 규칙을 생성할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> execve <span class=\"token parameter variable\">-k</span> exploitation_attempt</code></pre></div>\n<p>T1606: Modify Cloud Compute Infrastructure:</p>\n<blockquote>\n<p>이 기법은 공격자가 클라우드 인프라의 구성을 변경하는 것입니다. 이는 대부분 클라우드 제공 업체의 관리 콘솔 또는 API를 통해 이루어지므로 auditd로 직접적으로 감지하기는 어렵습니다. 그러나 관련 도구에 대한 접근을 모니터링 할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /path/to/aws/cli <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> cloud_infra_modification\n<span class=\"token parameter variable\">-w</span> /path/to/azure/cli <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> cloud_infra_modification</code></pre></div>\n<p>T1056: Input Capture:</p>\n<blockquote>\n<p>공격 기법은 키보드 입력을 캡처하는 것을 포함하므로, 이를 직접 모니터링하는 auditd 규칙은 존재하지 않습니다. 대신, 의심스러운 프로세스가 /dev/input/*에 접근하는 것을 모니터링하는 것이 가능합니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/input/ <span class=\"token parameter variable\">-p</span> rwa <span class=\"token parameter variable\">-k</span> input_capture</code></pre></div>\n<p>T1111: Two-Factor Authentication Interception:</p>\n<blockquote>\n<p>이 공격 기법은 2차 인증 정보를 가로채는 것으로, auditd가 이를 직접 탐지할 수는 없습니다. 우회적인 방법으로, 의심스러운 프로세스가 시스템 메일 spool(/var/spool/mail/)에 접근하거나 OTP 관련 프로세스와 연관된 파일에 접근하는 것을 감지하는 것이 가능합니다.</p>\n</blockquote>\n<p>T1621: Exfiltration Over Other Network Medium:</p>\n<blockquote>\n<p>이 공격 기법은 네트워크 외부로의 데이터 유출을 나타내며, 이를 직접 탐지하는 auditd 규칙은 없습니다. auditd는 보다 저수준의 시스템 호출을 모니터링하는데, 네트워크 트래픽 모니터링은 이와 벗어납니다.</p>\n</blockquote>\n<p>T1040: Network Sniffing:</p>\n<blockquote>\n<p>이 공격 기법은 네트워크 트래픽을 가로채는 것을 나타내며, auditd는 이를 직접 탐지할 수 없습니다. 하지만, 네트워크 스니핑을 위해 일반적으로 사용되는 툴에 대한 접근을 감지하는 규칙을 만들 수 있습니다.</p>\n</blockquote>\n<p>T1003: OS Credential Dumping:</p>\n<blockquote>\n<p>이 공격 기법은 시스템 자격 증명을 덤프하는 것을 나타냅니다. 시스템 자격 증명을 덤프하기 위해 일반적으로 액세스하는 파일이나 명령을 감시하는 auditd 규칙을 설정할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/run/secrets/kubernetes.io/serviceaccount/ <span class=\"token parameter variable\">-p</span> rwa\n<span class=\"token parameter variable\">-w</span> /var/lib/samba/private/sam.ldb <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-k</span> sam_dump\n<span class=\"token parameter variable\">-w</span> /etc/security/opasswd <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-k</span> sam_dump\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/proc/*/mem <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>w <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-k</span> lsass_memory_dump\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/proc/*/maps <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>r <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-k</span> lsass_memory_dump</code></pre></div>\n<p>T1649: Cloud Network Manipulation</p>\n<blockquote>\n<p>이 공격 기법은 공격자가 클라우드 네트워크 인프라의 요소를 조작하거나 제어하는 방법을 포함합니다. 이것은 auditd로 감지하기 어렵습니다. 그 이유는 auditd가 주로 운영 체제 수준에서의 작업을 감지하도록 설계되었기 때문입니다. 이런 유형의 공격을 감지하려면 클라우드 서비스 공급자(CSP)의 로깅 및 모니터링 기능을 활용해야 합니다.</p>\n</blockquote>\n<p>T1558: Steal or Forge Kerberos Tickets</p>\n<blockquote>\n<p>이 기법은 공격자가 Kerberos 티켓을 훔치거나 변조하는 방법을 포함합니다. 아래의 auditd 규칙은 Kerberos 티켓 파일에 대한 모든 읽기, 쓰기, 실행 작업을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/krb5.keytab <span class=\"token parameter variable\">-p</span> rwxa <span class=\"token parameter variable\">-k</span> krb5</code></pre></div>\n<p>T1539: Steal Web Session Cookie</p>\n<blockquote>\n<p>웹 세션 쿠키를 도난당하는 것은 auditd로 감지하기 어려운 활동입니다. auditd는 주로 시스템 및 응용 프로그램 수준에서의 활동을 모니터링하는데, 웹 세션 쿠키는 브라우저와 웹 서버 사이에서 주고받는 정보입니다. 이런 유형의 공격을 감지하려면 보안 웹 게이트웨이, 방화벽, 또는 웹 애플리케이션 방화벽 같은 네트워크 보안 솔루션을 사용해야 합니다.</p>\n</blockquote>\n<p>T1552: Unsecured Credentials</p>\n<blockquote>\n<p>이 공격 기법은 저장된 인증 정보가 적절하게 보호되지 않아 공격자에게 노출되는 상황을 다룹니다. 이는 특정 시나리오와 환경에 따라 다르기 때문에 일반적인 auditd 규칙을 제공하는 것이 어렵습니다. 하지만 일반적으로 중요한 인증 정보를 저장하는 데 사용되는 파일이나 디렉토리에 대한 접근을 모니터링하는 auditd 규칙을 사용할 수 있습니다.</p>\n</blockquote>\n<h3 id=\"️-4discovery\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4discovery\" aria-label=\"️ 4discovery permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4.discovery</h3>\n<p>T1087: Account Discovery</p>\n<blockquote>\n<p>공격자가 시스템에서 사용자 계정 정보를 수집하는 방법에 대한 기법입니다. Linux에서 사용자 계정 정보는 주로 /etc/passwd 파일에 저장되므로, 이 파일에 대한 읽기 작업을 감지하는 auditd 규칙을 설정할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> r <span class=\"token parameter variable\">-k</span> account_discovery</code></pre></div>\n<p>T1010: Application Window Discovery</p>\n<blockquote>\n<p>공격자가 시스템에서 열려 있는 응용 프로그램의 창을 식별하는 방법에 대한 기법입니다. 이는 Linux의 auditd로 직접 감지하기 어려운 활동입니다. GUI 관련 활동은 시스템 호출 수준에서 감지하기 어렵습니다.</p>\n</blockquote>\n<p>T1217: Browser Bookmark Discovery</p>\n<blockquote>\n<p>이 기법은 공격자가 웹 브라우저의 즐겨찾기를 수집하는 방법을 다룹니다. 일반적으로 이는 브라우저의 설정 파일에서 진행되므로, 해당 파일에 대한 접근을 감지하는 auditd 규칙을 설정할 수 있습니다. 예를 들어, Firefox 브라우저의 경우:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /home/*/ .mozilla/ <span class=\"token parameter variable\">-p</span> r <span class=\"token parameter variable\">-k</span> bookmark_discovery</code></pre></div>\n<p>T1652: Data Manipulation %%%</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 내 데이터를 조작하는 방법을 다룹니다. 이는 특정 시나리오와 환경에 따라 다르기 때문에, 일반적인 auditd 규칙을 제공하는 것은 어렵습니다. 그러나 중요한 파일에 대한 쓰기 작업을 감지하는 규칙을 설정할 수 있습니다.</p>\n</blockquote>\n<p>T1083: File and Directory Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 파일 및 디렉토리를 탐색하는 방법에 대한 기법입니다. 이는 ls, find와 같은 명령을 사용하거나, 직접 시스템 호출을 통해 수행될 수 있습니다. 이러한 작업을 감지하는 일반적인 auditd 규칙을 설정하는 것은 어렵습니다.</p>\n</blockquote>\n<p>T1046: Network Service Scanning</p>\n<blockquote>\n<p>공격자가 네트워크 서비스를 스캔하는 방법을 다룹니다. 이러한 활동은 주로 시스템 외부에서 발생하므로, Linux auditd는 이를 감지하는데 적합하지 않습니다. 이런 경우 네트워크 기반 IDS(Intrusion Detection System) 또는 방화벽 로그를 사용하는 것이 더 적합합니다.</p>\n</blockquote>\n<p>T1135: Network Share Discovery</p>\n<blockquote>\n<p>공격자가 네트워크 공유를 찾는 방법을 다룹니다. 이는 주로 smbclient나 mount와 같은 도구를 사용해 수행되며, auditd는 이러한 도구의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/smbclient <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_share_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/mount <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_share_discovery</code></pre></div>\n<p>T1201: Password Policy Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 비밀번호 정책을 알아내는 방법을 다룹니다. 이는 주로 /etc/login.defs 파일을 읽는 것으로 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/login.defs <span class=\"token parameter variable\">-p</span> r <span class=\"token parameter variable\">-k</span> password_policy_discovery</code></pre></div>\n<p>T1120: Peripheral Device Discovery</p>\n<blockquote>\n<p>공격자가 주변장치를 알아내는 방법을 다룹니다. 이는 주로 lsusb나 lspci와 같은 명령을 사용해 수행되며, auditd는 이러한 명령의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/lsusb <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>peripheral_device_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/lspci <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>peripheral_device_discovery</code></pre></div>\n<p>T1069: Permission Groups Discovery</p>\n<blockquote>\n<p>공격자가 권한 그룹 정보를 알아내는 방법을 다룹니다. 이는 주로 /etc/group 파일을 읽는 것으로 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/group <span class=\"token parameter variable\">-p</span> r <span class=\"token parameter variable\">-k</span> permission_groups_discovery</code></pre></div>\n<p>T1057: Process Discovery</p>\n<blockquote>\n<p>공격자가 시스템에서 실행 중인 프로세스를 발견하려고 시도하는 기법을 다룹니다. 이는 주로 ‘ps’, ‘top’ 같은 명령을 사용하여 수행됩니다. 이러한 명령의 사용을 감지하려면 다음과 같은 auditd 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/ps <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>process_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/top <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>process_discovery</code></pre></div>\n<p>T1018: Remote System Discovery</p>\n<blockquote>\n<p>공격자가 네트워크 상의 다른 시스템을 탐색하는 기법을 다룹니다. ‘ping’, ‘arp’ 같은 도구들이 사용될 수 있으며, 이러한 도구의 사용을 감지하려면 다음과 같은 auditd 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/ping <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>remote_system_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/arp <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>remote_system_discovery</code></pre></div>\n<p>T1518: Software Discovery</p>\n<blockquote>\n<p>공격자가 시스템에 설치된 소프트웨어를 파악하려는 시도를 다룹니다. ‘dpkg’, ‘rpm’ 같은 패키지 매니저 도구를 사용하여 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/dpkg <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>software_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/rpm <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>software_discovery</code></pre></div>\n<p>T1082: System Information Discovery</p>\n<blockquote>\n<p>공격자가 시스템 정보를 수집하는 기법을 다룹니다. ‘uname’, ‘hostname’, ‘lscpu’ 등의 명령이 사용될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/uname <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>system_info_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/hostname <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>system_info_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/lscpu <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>system_info_discovery</code></pre></div>\n<p>T1614: System Location Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 물리적 또는 가상 위치를 파악하려는 시도를 다룹니다. 예를 들어, IP 주소, MAC 주소, 시스템 시간, 시스템 설정 등을 통해 파악할 수 있습니다. 이는 복잡하고 다양한 방법으로 수행될 수 있기 때문에, 특정 auditd 규칙을 제시하기 어렵습니다. 시스템 설정 파일이나 네트워크 관련 명령의 사용을 감시하는 규칙이 도움이 될 수 있습니다.</p>\n</blockquote>\n<p>T1016: System Network Configuration Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 네트워크 구성을 파악하려는 시도를 다룹니다. ‘ip’, ‘ifconfig’, ‘netstat’, ‘ss’ 등의 명령이 사용될 수 있습니다. 이러한 명령의 사용을 감지하려면 다음과 같은 auditd 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/sbin/ip <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_config_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/sbin/ifconfig <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_config_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/netstat <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_config_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/ss <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_config_discovery</code></pre></div>\n<p>T1049: System Network Connections Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 네트워크 연결을 파악하려는 시도를 다룹니다. 이는 ‘ss’, ‘netstat’ 등의 도구를 사용하여 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/ss <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_connections_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/netstat <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>network_connections_discovery</code></pre></div>\n<p>T1033: System Owner/User Discovery</p>\n<blockquote>\n<p>공격자가 시스템의 사용자를 파악하려는 시도를 다룹니다. ‘id’, ‘who’, ‘w’, ‘last’ 등의 명령을 사용하여 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/id <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>user_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/who <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>user_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/w <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>user_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/last <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>user_discovery</code></pre></div>\n<p>T1007: System Service Discovery</p>\n<blockquote>\n<p>공격자가 시스템 서비스를 파악하려는 시도를 다룹니다. ‘systemctl’, ‘service’ 등의 명령을 사용하여 수행될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/systemctl <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>service_discovery\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/service <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span>service_discovery</code></pre></div>\n<h3 id=\"️-5lateral-movement\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-5lateral-movement\" aria-label=\"️ 5lateral movement permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 5.Lateral Movement</h3>\n<p>T1210: Exploitation of Remote Services</p>\n<blockquote>\n<p>이 기법에서 공격자는 원격 서비스의 취약점을 이용하여 악성 코드를 실행하거나 정보를 빼낼 수 있습니다. auditd는 이벤트 기반 로깅 시스템이므로 원격 서비스의 취약점을 직접 탐지하는 데는 제한적입니다. 대신, 취약한 서비스에 대한 액세스를 모니터링할 수 있습니다.</p>\n</blockquote>\n<p>T1534: Internal Spearphishing</p>\n<blockquote>\n<p>내부 스피어피싱은 공격자가 조직 내부에서 사칭 이메일을 보내 사원들을 속이는 기법입니다. 이는 일반적으로 외부에서 시작되며, auditd로 감지하는 것은 어렵습니다.</p>\n</blockquote>\n<p>T1570: Lateral Tool Transfer</p>\n<blockquote>\n<p>이 기법에서 공격자는 도구나 파일을 시스템 간에 전송합니다. auditd를 사용하여 파일 시스템 이벤트를 모니터링하고 특정 파일 또는 디렉터리의 변경을 감지할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">dir</span><span class=\"token operator\">=</span>/path/to/monitor/ <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>w <span class=\"token parameter variable\">-k</span> lateral_tool_transfer</code></pre></div>\n<p>T1563: Remote Service Session Hijacking</p>\n<blockquote>\n<p>이 기법은 공격자가 원격 서비스 세션을 탈취하여 원격 시스템에 액세스하는 것을 의미합니다. auditd를 사용하여 특정 프로세스에 대한 이벤트를 모니터링하고 알려진 이상 행동을 감지할 수 있습니다.</p>\n</blockquote>\n<p>T1021: Remote Services</p>\n<blockquote>\n<p>이 기법은 공격자가 원격 서비스를 사용하여 시스템에 액세스하는 것을 포함합니다. auditd를 사용하여 이러한 서비스의 이벤트를 모니터링할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/sshd <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-k</span> remote_service</code></pre></div>\n<p>T1080: Taint Shared Content</p>\n<blockquote>\n<p>이 기법은 공격자가 공유 리소스를 조작하여 사용자가 접근할 때 악성 행동을 유발하는 것을 의미합니다. 이러한 공격을 감지하려면, auditd를 사용하여 공유 디렉터리에 대한 변경을 모니터링하면 됩니다. 예를 들어, /usr/shared 디렉토리에 대한 변경을 모니터링하는 규칙은 다음과 같을 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/shared <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> shared_content</code></pre></div>\n<hr>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22\">https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22</a><br>\n<a href=\"https://blog.naver.com/alice_k106/221803861645\">https://blog.naver.com/alice_k106/221803861645</a></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#-1-attck%EB%9E%80-br\">🔴 1. ATT&#x26;CK란 <br></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\">🟡 2. 12개 Tactics 전술<br></a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-3-credential-access\">⌨️ 3. Credential Access</a></li>\n<li><a href=\"#%EF%B8%8F-4discovery\">⌨️ 4.discovery</a></li>\n<li><a href=\"#%EF%B8%8F-5lateral-movement\">⌨️ 5.Lateral Movement</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"👋 소개 ATT&CK 리눅스 공격 기법에 대해 알아보자🙌 🔴 1. ATT&CK란  ATT&CK는 (미터)라는 조직이 개발한 과 에 대한 입니다. “ATT&CK”는 “Adversarial Tactics, Techniques, and Common Knowledge”의 약자로,공격자의 전술, 기술, 공통 지식을 다루고 이를 통해 보안 전문가와 조직은 공격자가 사용하는 다양한 전술과 기술을 이해하고, 그에 대응하는 할 수 있습니다. ATT&CK 프레임워크는 과 로 구성됩니다. 전술은 공격자가 공격을 수행하는 고수준의 목표를 의미하며, 기술은 실제로 사용되는 공격 기법과 방법을 설명합니다. 각 전술과 기술은 공격자의 행위를 카테고리화하고 문서화하여 보안 커뮤니티에 제공됩니다.  🟡 2. 12개 Tactics 전술 : 공격자가 시스템 또는 네트워크에 처음으로 접근하기 위해 사용하는 기법 전술 : 공격자가 악성 코드 또는 악성 스크립트를 실행하여 시스템 내에서 명령을 실행하는 전술 : 공격자가…","frontmatter":{"date":"June 15, 2023","title":"[보안]  ATT&CK - Linux 공격기법 정리 (3)","categories":"보안","author":"sb","emoji":"🔐"},"fields":{"slug":"/5-security-mitre-3/"}},"next":{"id":"0bf1f36a-4062-56c5-86e1-081e1b4bad79","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>ATT&#x26;CK 리눅스 공격 기법에 대해 알아보자🙌<br></p>\n<hr>\n<h3 id=\"-1-attck란-br\" style=\"position:relative;\"><a href=\"#-1-attck%EB%9E%80-br\" aria-label=\" 1 attck란 br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🔴 1. ATT&#x26;CK란 <br></h3>\n<p>ATT&#x26;CK는 (미터)라는 조직이 개발한 <code class=\"language-text\">공격 기술</code>과 <code class=\"language-text\">방어 기술</code>에 대한 <code class=\"language-text\">프레임워크</code>입니다. “ATT&#x26;CK”는 “Adversarial Tactics, Techniques, and Common Knowledge”의 약자로,공격자의 전술, 기술, 공통 지식을 다루고 이를 통해 보안 전문가와 조직은 공격자가 사용하는 다양한 전술과 기술을 이해하고, 그에 대응하는 <code class=\"language-text\">방어 전략을 수립</code>할 수 있습니다.<br></p>\n<p><strong>ATT&#x26;CK 프레임워크</strong>는 <code class=\"language-text\">전술(Tactics)</code>과 <code class=\"language-text\">기술(Techniques)</code>로 구성됩니다. 전술은 공격자가 공격을 수행하는 고수준의 목표를 의미하며, 기술은 실제로 사용되는 공격 기법과 방법을 설명합니다. 각 전술과 기술은 공격자의 행위를 카테고리화하고 문서화하여 보안 커뮤니티에 제공됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADiklEQVQ4y41UbUxbVRi+GmNqnMkSNftjdIkmRJMlxh+6bBpGJ2y0o3QICi0UJQpsgAtZMqBjQEuY0vXD7l7SdrRFR0fLvb3nnnPuPad37VC3+JEsW+b2A1FnIjFGnUuGSBBNSE17Wyj6x/ee3I9z3ue8532f570M2mqw+IIxJoRQStPpNIRQW4JFH20wuQ+IICzctAfCmBcE+8khk8nc09OVSqUKS6jgBCGUICwBFw0AoKqqfXCo0lD30u49DMM4RsdUNSVJ0v8CpzOZysoq3bbHjlqeadTf32GrIlQFEpDgFmNKN8sjpZSqerw+ne4hhmEefOC+toPMgfLneAHSFMUYFx1zIZmNPPO75Esly9WHzAzDWK1Noah4NWE80ahrsHTOzMzEYhewLJeCkVYJhBAAUjqdcZ1xP7vrhapq0+8rq9ls9ofFH/0s++iOJywt74iiiDaDwyIYQkopy00crrea6hp1D29/6ukyde7zu0srK2vrKH3l5XI9NxFIUVqSthZ5g0AIGy0tr7xqGveyH8Vmb87f/unOvd+WVniouJyDmbmPC9mhjWOXkA6xfClDpDh3Y37xr2z2ztLqz/dWb97+1cVORZxvJWPBLc6oBIwQFET6Rcrz51fmWGh4ekaS6UWCQYQbA57mNVRxNWAWRIrxvxSWH5IEMElH486Fi2XLl568FS77LvbiPLfrbnDnWmTH9+wjfrfeH4sQLEuFwxfliTACghS6HD31mavJY/NG9v5yeWd2bvv69LYb7OOj7z1vGK3ZPXx40O+UobxVJAjHE4lkQjwte3q/HnAsuFrBYEOgeSRUPsDtM3qaKjytNWPW8ZA7EZ8VAUiKIkJ4s9oI46mpD0eco+39R1rPH7UvOnq/HGoW+oyhzuqgpcHZ8uknV9b/Xp/l+YVvvkVYngyHZVnOgRVFCQSDxpra+rra1tfNNbXNtnC7jbSbuDf0DpPB/lpnb5frfde169eWl/+IxxM97x4LhyM5sKwoXp/fYDy0r2L/nr3l+gOG0+Nn3G5vx8nu+uNWW3db34k+n8/3gd8/POLo7x/o6u5huQmtZjnwgP3Um20dFfsPvt1+hOcFjPEsz0cno2e9Zzk/GzoXOj89raU2GQ4DAAilmzwTQoKhc9xEgBACIRRzvSeJkiiAJJ/kk6IowdyFECJ5eQKtsYtUQUKpoigg1+8QIvTff1NBC0WGtcl/APt23iQWmwkVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/04be1306bc101e5df67280573092fab4/01e7c/1.png\"\n        srcset=\"/static/04be1306bc101e5df67280573092fab4/e9ff0/1.png 180w,\n/static/04be1306bc101e5df67280573092fab4/f21e7/1.png 360w,\n/static/04be1306bc101e5df67280573092fab4/01e7c/1.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"-2-12개-tactics-전술br\" style=\"position:relative;\"><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\" aria-label=\" 2 12개 tactics 전술br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🟡 2. 12개 Tactics 전술<br></h2>\n<ul>\n<li><code class=\"language-text\">Initial Access</code>: 공격자가 시스템 또는 네트워크에 처음으로 접근하기 위해 사용하는 기법 전술</li>\n<li><code class=\"language-text\">Execution</code>: 공격자가 악성 코드 또는 악성 스크립트를 실행하여 시스템 내에서 명령을 실행하는 전술</li>\n<li><code class=\"language-text\">Persistence</code>: 공격자가 시스템에 대한 지속적인 액세스를 유지하기 위해 사용하는 기법을 포함한 전술입니다.</li>\n<li><code class=\"language-text\">Privilege Escalation</code>: 공격자가 권한 상승을 시도하여 시스템 내에서 더 높은 수준의 권한을 획득하는 전술입니다.</li>\n<li><code class=\"language-text\">Defense Evasion</code>: 공격자가 탐지 및 방어 기술을 피하고 자신의 활동을 감추는 기법을 사용하는 전술입니다.</li>\n<li><code class=\"language-text\">Credential Access</code>: 공격자가 인증 정보를 획득하여 시스템 또는 네트워크에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Discovery</code>: 공격자가 대상 시스템 및 네트워크를 조사하여 정보를 수집하는 전술입니다.</li>\n<li><code class=\"language-text\">Lateral Movement</code>: 공격자가 시스템 및 네트워크 내에서 이동하여 다른 시스템에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Collection</code>: 공격자가 획득한 정보를 수집하고 추출하는 전술입니다.</li>\n<li><code class=\"language-text\">Exfiltration</code>: 공격자가 훔친 데이터를 시스템 또는 네트워크 외부로 전송하는 전술입니다.</li>\n<li><code class=\"language-text\">Command and Control</code>: 공격자가 원격 명령 및 제어 인프라를 구축하고 시스템과 통신하는 전술입니다.</li>\n<li><code class=\"language-text\">Impact</code>: 공격자가 시스템 또는 네트워크에 직접적인 피해를 입히는 전술입니다.</li>\n</ul>\n<hr>\n<h3 id=\"️-3-persistence\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-persistence\" aria-label=\"️ 3 persistence permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. Persistence</h3>\n<p>T1098: “Account Manipulation”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 내의 사용자 계정을 조작하여 권한 상승, 계정 접근 또는 계정 동작 제어를 시도하는 것을 의미합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> user_account_changes\n<span class=\"token parameter variable\">-w</span> /etc/shadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> user_account_changes\n<span class=\"token parameter variable\">-w</span> /etc/group <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> group_account_changes\n<span class=\"token parameter variable\">-w</span> /etc/gshadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> group_account_changes</code></pre></div>\n<p>T1547: “Boot or Logon Autostart Execution: Boot or Logon Initialization Scripts”</p>\n<blockquote>\n<p>이는 공격자가 시스템의 부팅 시나 로그온 시에 자동으로 실행되도록 코드나 프로그램을 설정하는 방식을 말합니다. 이 방식은 공격자가 시스템에 지속적으로 남아있을 수 있게 해줍니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/systemd/system/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> autostart\n<span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> autostart\n<span class=\"token parameter variable\">-w</span> /etc/cron.* <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> autostart\n<span class=\"token parameter variable\">-w</span> /etc/init.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> autostart\n<span class=\"token parameter variable\">-w</span> /etc/rc.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> autostart</code></pre></div>\n<p>T1037: “Boot or Logon Initialization Scripts”</p>\n<blockquote>\n<p>이 기법은 시스템이 부팅하거나 사용자가 로그인할 때 실행되는 스크립트에 코드를 삽입하여, 공격자가 시스템에 지속적으로 남아 있을 수 있도록 하는 방식입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/systemd/system/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /etc/cron.* <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /etc/init.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /etc/rc.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /home/*/.bashrc <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts\n<span class=\"token parameter variable\">-w</span> /home/*/.bash_profile <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> init_scripts</code></pre></div>\n<p>T1176: “Browser Extensions”</p>\n<blockquote>\n<p>이 기법은 공격자가 악성 브라우저 확장 프로그램을 사용하여 사용자의 웹 브라우징 활동을 감시하거나 조작하는 것을 의미합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /home/*/.config/google-chrome/Default/Extensions/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> browser_extension</code></pre></div>\n<p>T1554: “Compromise Client Software Binary”</p>\n<blockquote>\n<p>이 기법은 공격자가 클라이언트 소프트웨어의 바이너리를 조작하여, 사용자가 정상적인 동작을 예상하는 소프트웨어를 실행할 때 악의적인 동작이 수행되도록 하는 것입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> compromise_client_software_binary\n<span class=\"token parameter variable\">-w</span> /usr/sbin/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> compromise_client_software_binary</code></pre></div>\n<p>T1136: “Create Account”</p>\n<blockquote>\n<p>이는 공격자가 시스템에서 새 사용자 계정을 생성함으로써 영구적으로 시스템에 액세스하려는 시도를 의미합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> create_account</code></pre></div>\n<p>T1543: “Create or Modify System Process”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 프로세스를 만들거나 수정하여 유지 관리가 되지 않는 또는 악의적인 활동을 숨기려고 할 때 사용됩니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/systemd/system/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> modify_system_process</code></pre></div>\n<p>T1546: “Event Triggered Execution”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템의 다양한 이벤트 트리거를 이용하여 악성 코드를 실행하려고 할 때 사용됩니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span></code></pre></div>\n<p>T1133: “External Remote Services”</p>\n<blockquote>\n<p>이 기법에 대한 감지는 시스템의 네트워크 트래픽을 모니터링하거나, 로그인 시도를 기록하는 것이 포함될 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/log/auth.log <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> external_remote_service</code></pre></div>\n<p>T1574: “Hijack Execution Flow”</p>\n<blockquote>\n<p>공격자가 정상적인 프로세스의 실행 흐름을 가로채는 경우를 설명합니다. 이 기법에는 여러 서브-기법이 있으며, 각각의 특정 시나리오에 따라 다른 auditd 규칙이 필요할 수 있습니다.\nLinux에서는 DLL 대신 공유 라이브러리(shared library)를 사용하며, 이를 감지하는 auditd 규칙은 일반적으로 제공되지 않습니다. 대신, 프로그램의 실행 파일이나 사용하는 라이브러리 파일의 변경을 감지하는 것이 가능합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/local/lib/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> hijack_execution_flow</code></pre></div>\n<p>T1556: “Modify Authentication Process\"\"</p>\n<blockquote>\n<p>기법은 공격자가 시스템 또는 서비스의 인증 프로세스를 변경하여 접근을 허용하거나 통제하는 방법에 대해 설명합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /home/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth_modify</code></pre></div>\n<blockquote>\n<p>예를 들어, “.bash_profile and .bashrc” 서브-기법은 사용자의 bash 프로필 또는 rc 파일을 변경하여 로그인 세션에 대한 통제를 얻는 기법을 설명합니다. 이를 감지하기 위한 일반적인 auditd 규칙은 다음과 같습니다.</p>\n</blockquote>\n<p>T1542: “System Network Configuration Discovery”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템의 네트워크 설정 및 구성을 파악하는 과정을 설명합니다. 이런 정보는 공격자가 네트워크 통신을 이해하고, 추가적인 행동을 계획하는데 사용될 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/ipconfig <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/sbin/ifconfig <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/route <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/arp <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/netstat <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/lsof <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/ss <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> network_discovery</code></pre></div>\n<p>T1053: “Scheduled Task/Job”</p>\n<blockquote>\n<p>기법은 공격자가 작업 스케줄러 또는 cron과 같은 유틸리티를 사용하여 셸 스크립트 또는 바이너리를 주기적으로 실행하도록 설정하는 것입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span>\n<span class=\"token parameter variable\">-w</span> /etc/cron.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span>\n<span class=\"token parameter variable\">-w</span> /var/spool/cron/crontabs/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span></code></pre></div>\n<p>T1505: “Server Software Component”</p>\n<blockquote>\n<p>이 기법은 공격자가 웹 서버의 소프트웨어 구성 요소를 조작하는 것을 설명합니다. 이는 웹 서버의 취약점을 이용하거나, 공격자가 서버에 악성 코드를 삽입하는 방식으로 이루어질 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/httpd/conf/httpd.conf <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> webserver_attack</code></pre></div>\n<p>T1205: “Traffic Signaling”</p>\n<blockquote>\n<p>이 기법은 공격자가 C2 서버와 통신하기 위해 네트워크 트래픽에 신호나 데이터를 숨기는 방법을 설명합니다. 이런 행위는 네트워크 모니터링 도구를 우회하는데 사용될 수 있습니다.\n이 기법을 직접 감지하는 auditd 규칙은 존재하지 않습니다. 그 이유는 auditd가 파일과 시스템 호출의 감사에 초점을 맞추고 있으며, 네트워크 트래픽 패턴이나 내용을 분석하도록 설계되지 않았기 때문입니다.\n이런 유형의 공격을 감지하려면, IDS(프루시지 네트워크 감지 시스템) 또는 IPS(프루시지 네트워크 차단 시스템)와 같은 네트워크 감지 도구나, 패킷 캡처 및 분석 도구를 사용해야 합니다.\n또한 공격자가 사용할 수 있는 다양한 트래픽 신호화 기법이 있으므로, 이를 감지하는 정확한 방법은 사용하는 신호화 기법에 따라 다를 수 있습니다.</p>\n</blockquote>\n<p>T1078: “Valid Accounts”</p>\n<blockquote>\n<p>이 기법은 공격자가 유효한 계정(즉, 정상적으로 생성된 사용자 계정)을 이용하는 것을 설명합니다. 공격자는 다양한 방법으로 이 계정을 얻을 수 있습니다. 예를 들어, 초기 접근 방법으로 계정 정보를 탈취하거나, 브루트 포싱을 사용하여 계정에 접근할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/sudo <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-k</span> privileged_command\n\n<span class=\"token operator\">></span> 이 규칙은 auid <span class=\"token punctuation\">(</span>Audit User ID<span class=\"token punctuation\">)</span>가 <span class=\"token number\">1000</span> 이상이고, auid가 <span class=\"token number\">4294967295</span> <span class=\"token punctuation\">(</span>unset auid<span class=\"token punctuation\">)</span>가 아닌 경우에, /usr/bin/sudo를 실행하려는 모든 시도를 로그로 남깁니다. 이 규칙을 사용하면 시스템에서 권한 있는 명령어가 실행되는 모든 시도를 감지할 수 있습니다.\n</code></pre></div>\n<h3 id=\"️-4privilege-escalation\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4privilege-escalation\" aria-label=\"️ 4privilege escalation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4.Privilege Escalation</h3>\n<p>T1548: “Abuse Elevation Control Mechanism”</p>\n<blockquote>\n<p>기법은 일반적으로 Windows 환경에서 발생합니다. 이 기법은 공격자가 정상적인 권한 상승 제어 메커니즘을 악용하여 더 높은 권한을 획득하려고 시도하는 것을 설명합니다. 여기에는 User Account Control (UAC) 우회, AppInit DLLs, Plist 수정 등의 서브테크닉이 포함됩니다.</p>\n</blockquote>\n<blockquote>\n<p>Linux 환경에서는 이러한 권한 상승 제어 메커니즘이 적용되지 않거나, 다르게 작동할 수 있습니다. 따라서 Linux의 auditd를 사용하여 이 기법을 직접 감지하는 것은 불가능하거나 의미가 없을 수 있습니다.</p>\n</blockquote>\n<p>T1547: “Boot or Logon Autostart Execution”</p>\n<blockquote>\n<p>시스템 시작 시 또는 사용자 로그인 시에 자동으로 코드를 실행하는 방법에 대한 공격 기법입니다. 이는 공격자가 시스템의 지속성을 유지하고, 보안 솔루션을 우회하는 데 사용됩니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /home/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> shell_config_mod\n<span class=\"token parameter variable\">-w</span> /etc/systemd/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> systemd_mod\n<span class=\"token parameter variable\">-w</span> /etc/cron.d/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> cron_mod</code></pre></div>\n<p>T1037: “Boot or Logon Initialization Scripts”</p>\n<blockquote>\n<p>시스템 부팅 시 또는 사용자 로그인 시에 자동으로 스크립트를 실행하는 방법에 대한 공격 기법입니</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /home/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> shell_config_mod</code></pre></div>\n<p>T1543: “로그 및 감사 설정 변경”</p>\n<blockquote>\n<p>이 기법은 공격자가 고유한 시스템 프로세스를 생성하거나 수정하여 악의적 행동을 캡슐화하고 우회적으로 실행하는 방법에 대한 것입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/systemd/system/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> systemd_service_modification</code></pre></div>\n<p>T1611: “Escape to Host”</p>\n<blockquote>\n<p>정보 없음</p>\n</blockquote>\n<p>T1546: “Event Triggered Execution: Event Triggered Execution”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 이벤트를 트리거로 사용하여 악성 코드를 실행하는 방법을 설명합니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> execve <span class=\"token parameter variable\">-k</span> execution\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> execve <span class=\"token parameter variable\">-k</span> execution</code></pre></div>\n<blockquote>\n<p>이 규칙은 실행되는 모든 프로세스를 감지하므로, 많은 양의 로그를 생성할 수 있습니다. 따라서, 특정 이벤트에 대한 트리거를 기반으로 하는 프로세스 실행을 감지하려면, 더 구체적인 경로나 조건을 지정해야 할 수 있습니다.</p>\n</blockquote>\n<p>T1068: Exploitation for Privilege Escalation”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템에서 보안 취약점을 이용해 자신의 권한을 상승시키는 방법을 설명합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> setuid,setreuid,setresuid,setgid,setregid,setresgid <span class=\"token parameter variable\">-k</span> privilege-escalation\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> setuid,setreuid,setresuid,setgid,setregid,setresgid <span class=\"token parameter variable\">-k</span> privilege-escalation</code></pre></div>\n<blockquote>\n<p>이러한 시스템 호출은 합법적인 프로그램에서도 사용될 수 있으므로, 이 규칙이 생성하는 로그에는 많은 양의 합법적인 이벤트가 포함될 수 있습니다. 따라서 필요에 따라 이 규칙을 조정하거나 추가 조사를 수행해야 할 수 있습니다.</p>\n</blockquote>\n<p>T1574: “Hijack Execution Flow”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템에서 정상적인 실행 흐름을 제어하여 악의적인 행위를 수행하도록 시스템을 조작하는 방법을 설명합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> open,openat <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">exit</span><span class=\"token operator\">=</span>-EACCES <span class=\"token parameter variable\">-k</span> file_access\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> open,openat <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">exit</span><span class=\"token operator\">=</span>-EACCES <span class=\"token parameter variable\">-k</span> file_access</code></pre></div>\n<blockquote>\n<p>이 규칙은 open 및 openat 시스템 호출에서 EACCES (접근 권한 없음) 오류로 종료되는 모든 이벤트를 감지하고, file_access 키를 해당 이벤트에 부여합니다. 이렇게 하면 권한이 없는 파일에 대한 액세스 시도를 감지할 수 있습니다.</p>\n</blockquote>\n<p>T1055: “Process Injection”</p>\n<blockquote>\n<p>이 기법은 공격자가 실행 중인 프로세스에 악의적인 코드를 삽입하여 코드 실행을 숨기거나 프로세스의 권한을 훔쳐서 악용하는 방법을 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> ptrace <span class=\"token parameter variable\">-k</span> process_injection\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> ptrace <span class=\"token parameter variable\">-k</span> process_injection</code></pre></div>\n<p>T1053: “Scheduled Task/Job”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템의 예약된 작업이나 작업을 만들거나 변경하여 소프트웨어를 실행하고 시스템에서 지속성, 권한 상승, 그리고 잠재적으로 시스템에서의 다른 활동들을 숨기는 것을 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /etc/cron.hourly <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /etc/cron.daily <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /etc/cron.weekly <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /etc/cron.monthly <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /etc/cron.d <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /var/spool/cron/crontabs <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task\n<span class=\"token parameter variable\">-w</span> /var/spool/cron/atjobs <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> scheduled_task</code></pre></div>\n<p>T1078: “Valid Accounts”</p>\n<blockquote>\n<p>이 기법은 공격자가 공격 목표로 선택한 시스템에 유효한 계정을 사용하여 접근하는 것을 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth\n<span class=\"token parameter variable\">-w</span> /etc/shadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth\n<span class=\"token parameter variable\">-w</span> /etc/group <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth\n<span class=\"token parameter variable\">-w</span> /etc/gshadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/sudo <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-k</span> auth</code></pre></div>\n<hr>\n<h3 id=\"️-5defense-evasion\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-5defense-evasion\" aria-label=\"️ 5defense evasion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 5.Defense Evasion</h3>\n<p>T1548: “Abuse Elevation Control Mechanism”</p>\n<blockquote>\n<p>이 기법은 공격자가 권한 상승을 위해 시스템의 기능이나 서비스를 악용하는 것을 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/sudo <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> setuid\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> <span class=\"token function\">chmod</span> <span class=\"token parameter variable\">-S</span> fchmod <span class=\"token parameter variable\">-S</span> chmodat <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">euid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-k</span> setuid\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> setresuid <span class=\"token parameter variable\">-S</span> setreuid <span class=\"token parameter variable\">-S</span> setuid <span class=\"token parameter variable\">-S</span> setresgid <span class=\"token parameter variable\">-S</span> setregid <span class=\"token parameter variable\">-S</span> setgid <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">euid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-k</span> setuid</code></pre></div>\n<p>T1622: “debugger evsion”</p>\n<blockquote>\n<p>정보 없음</p>\n</blockquote>\n<p>T1140: “Deobfuscate/Decode Files or Information”</p>\n<blockquote>\n<p>이 기법은 공격자가 악성 페이로드나 정보를 숨기기 위해 쓰인 난독화 또는 인코딩을 해제하는 경우를 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/base64 <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> deobfuscate_decode</code></pre></div>\n<p>T1480: “Execution Guardrails”</p>\n<blockquote>\n<p>이 기법은 악성 코드 실행을 특정 조건이 충족되었을 때만 허용하는 것을 포함합니다. 예를 들어 공격자는 특정 시간, 날짜, 시스템, 지역 등의 조건이 충족되었을 때만 악성 코드가 실행되도록 설정할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/crontab <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> execution_guardrails\n<span class=\"token parameter variable\">-w</span> /usr/bin/at <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> execution_guardrails</code></pre></div>\n<p>T1211: “Exploitation for Defense Evasion”</p>\n<blockquote>\n<p>이 공격 기법은 공격자가 시스템의 보호 기능을 우회하거나 비활성화하기 위해 취약점을 이용하는 것을 말합니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/setenforce <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> exploit_defense_evasion\n<span class=\"token parameter variable\">-w</span> /etc/selinux/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> exploit_defense_evasion</code></pre></div>\n<p>T1222: “File Permissions Modification”</p>\n<blockquote>\n<p>공격 기법은 공격자가 파일 또는 디렉토리의 권한을 변경하여 공격을 용이하게 만드는 것을 말합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> chmod,chown,fchmod,fchown <span class=\"token parameter variable\">-k</span> file_perm_mod\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> chmod,chown,fchmod,fchown <span class=\"token parameter variable\">-k</span> file_perm_mod</code></pre></div>\n<p>T1564: “Hide Artifacts”</p>\n<blockquote>\n<p>이는 공격자가 시스템에서 자신의 행동 흔적을 숨기려 할 때 사용하는 기법입니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> stat,stat64,lstat,lstat64,fstat,fstat64 <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-k</span> hidden_artifacts</code></pre></div>\n<p>T1574: “Hijack Execution Flow”</p>\n<blockquote>\n<p>이 기법은 공격자가 정상적인 실행 흐름을 가로채어 악의적인 코드를 실행하게 하는 방법을 설명합니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> setxattr <span class=\"token parameter variable\">-k</span> ld_preload_change</code></pre></div>\n<p>T1562: “Impair Defenses”</p>\n<blockquote>\n<p>이는 공격자가 시스템의 보안 메커니즘을 해제하거나 방해하는 방법을 설명합니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/auditd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auditconfig</code></pre></div>\n<p>T1070: “Indicator Removal on Host”</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 로그나 기타 징표를 삭제하여 공격 흔적을 지우려는 경우입니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> unlink,unlinkat,rename,renameat <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">!=</span><span class=\"token number\">4294967295</span> <span class=\"token parameter variable\">-k</span> indicator_removal</code></pre></div>\n<p>T1036: “Masquerading”</p>\n<blockquote>\n<p>공격자가 시스템 또는 네트워크 내에서 악성 행동을 숨기기 위해 프로세스 또는 프로그램을 정상적인 것처럼 보이게 하는 기법입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /bin <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> masquerade_detection</code></pre></div>\n<p>T1556: “Modify Authentication Process:</p>\n<blockquote>\n<p>인증 프로세스에 영향을 미치는 파일들을 감시하는 규칙을 적용할 수 있습니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/passwd <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth_modification\n<span class=\"token parameter variable\">-w</span> /etc/shadow <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> auth_modification</code></pre></div>\n<p>T1027: “Obfuscated Files or Information:</p>\n<blockquote>\n<p>이 기법은 파일을 난독화하거나 정보를 숨기는 방법을 포함하므로, 특정 난독화 도구에 대한 접근이나 실행을 감지하는 규칙을 설정할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /path/to/obfuscation_tool <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> obfuscation_detection</code></pre></div>\n<p>T1542: “Pre-OS boot”</p>\n<blockquote>\n<p>공격자가 “Pre-OS boot”는 운영 체제가 부팅되기 전에 발생하는 과정을 가리킵니다.\n정보없음</p>\n</blockquote>\n<p>T1055: “Process Injection”</p>\n<blockquote>\n<p>공격자가 다른 프로세스의 주소 공간에 악성 코드를 주입하는 기법입니다. 이를 감지하는 규칙을 작성하는 것은 복잡할 수 있지만, ptrace(프로세스 추적)와 관련된 활동을 모니터링 하는 것이 가능한 방법 중 하나입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> ptrace <span class=\"token parameter variable\">-k</span> process_injection\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> ptrace <span class=\"token parameter variable\">-k</span> process_injection</code></pre></div>\n<p>T1620: “Reflective Code Loading”</p>\n<blockquote>\n<p>이 기법은 바이너리 파일을 메모리에 직접 로드하는 공격 기법으로, 파일 시스템에 실제로 존재하는 바이너리가 아니라, 악성코드를 메모리에만 저장합니다\n정보없음</p>\n</blockquote>\n<p>T1014: “Rootkit”</p>\n<blockquote>\n<p>루트킷은 시스템의 정상적인 동작을 숨기거나 변경하는 데 사용되며, 특히 신뢰할 수 있는 시스템 프로세스나 커널 모듈 등에서 사용됩니다</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/mem <span class=\"token parameter variable\">-p</span> rwxa <span class=\"token parameter variable\">-k</span> rootkit_activity\n<span class=\"token parameter variable\">-w</span> /dev/kmem <span class=\"token parameter variable\">-p</span> rwxa <span class=\"token parameter variable\">-k</span> rootkit_activity\n</code></pre></div>\n<p>T1553: “Subvert Trust Controls”</p>\n<blockquote>\n<p>신뢰하는 컴포넌트가 공격자에 의해 변조되었는지를 확인하는 것은 일반적으로 어렵습니다. 하지만, 공개키 인증서를 저장하는 파일에 대한 변경을 감지하는 것은 이러한 타입의 공격을 감지하는데 도움이 될 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/ssh/ssh_host_rsa_key <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> subvert_trust\n<span class=\"token parameter variable\">-w</span> /etc/ssh/ssh_host_dsa_key <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> subvert_trust\n<span class=\"token parameter variable\">-w</span> /etc/ssh/ssh_host_ecdsa_key <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> subvert_trust\n<span class=\"token parameter variable\">-w</span> /etc/ssh/ssh_host_ed25519_key <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> subvert_trust\n</code></pre></div>\n<p>T1218: “Signed Binary Proxy Execution”</p>\n<blockquote>\n<p>기법은 사인된 바이너리를 통해 악성 코드를 실행하는 것을 포함합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/powershell <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> signed_binary_proxy_execution\n<span class=\"token parameter variable\">-w</span> /usr/bin/cscript <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> signed_binary_proxy_execution\n<span class=\"token parameter variable\">-w</span> /usr/bin/wscript <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> signed_binary_proxy_execution\n<span class=\"token parameter variable\">-w</span> /usr/bin/rcsi <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> signed_binary_proxy_execution\n</code></pre></div>\n<p>T1205: “Traffic Signaling”</p>\n<blockquote>\n<p>이 기법은 특정 트래픽 패턴을 사용해 데이터를 전송하거나 커맨드를 신호로 전달합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> connect <span class=\"token parameter variable\">-k</span> web_traffic\n<span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> connect <span class=\"token parameter variable\">-k</span> web_traffic</code></pre></div>\n<p>T1078: “Valid Accounts”</p>\n<blockquote>\n<p>이 기법은 공격자가 계정을 공격하거나 재사용하는 데 사용합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/log/auth.log <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> valid_accounts\n<span class=\"token parameter variable\">-w</span> /var/log/secure <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> valid_accounts\n</code></pre></div>\n<p>T1497: “Virtualization/Sandbox Evasion”</p>\n<blockquote>\n<p>이 기법은 공격자가 가상 머신이나 샌드박스 환경을 감지하려고 할 때 사용됩니다. 가상화/샌드박스 회피를 직접적으로 감지하는 것은 매우 어렵지만, 특정 가상화 툴에 대한 파일 또는 프로세스 액세스를 모니터링하는 규칙을 생성할 수 있습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /proc/cpuinfo <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-k</span> virtualization_evasion\n<span class=\"token parameter variable\">-w</span> /proc/scsi/ <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-k</span> virtualization_evasion\n<span class=\"token parameter variable\">-w</span> /proc/bus/pci/devices <span class=\"token parameter variable\">-p</span> <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-k</span> virtualization_evasion</code></pre></div>\n<hr>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22\">https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22</a><br>\n<a href=\"https://blog.naver.com/alice_k106/221803861645\">https://blog.naver.com/alice_k106/221803861645</a></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#-1-attck%EB%9E%80-br\">🔴 1. ATT&#x26;CK란 <br></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\">🟡 2. 12개 Tactics 전술<br></a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-3-persistence\">⌨️ 3. Persistence</a></li>\n<li><a href=\"#%EF%B8%8F-4privilege-escalation\">⌨️ 4.Privilege Escalation</a></li>\n<li><a href=\"#%EF%B8%8F-5defense-evasion\">⌨️ 5.Defense Evasion</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 14, 2023","title":"[보안]  ATT&CK - Linux 공격기법 정리 (2)","categories":"보안","author":"sb","emoji":"🔐"},"fields":{"slug":"/5-security-mitre-2/"}},"prev":{"id":"bd2fa0f6-4b4a-5545-a910-21f48bd0d1a9","html":"<h2 id=\"-소개\" style=\"position:relative;\"><a href=\"#-%EC%86%8C%EA%B0%9C\" aria-label=\" 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👋 소개</h2>\n<p>ATT&#x26;CK 리눅스 공격 기법에 대해 알아보자🙌<br></p>\n<hr>\n<h3 id=\"-1-attck란-br\" style=\"position:relative;\"><a href=\"#-1-attck%EB%9E%80-br\" aria-label=\" 1 attck란 br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🔴 1. ATT&#x26;CK란 <br></h3>\n<p>ATT&#x26;CK는 (미터)라는 조직이 개발한 <code class=\"language-text\">공격 기술</code>과 <code class=\"language-text\">방어 기술</code>에 대한 <code class=\"language-text\">프레임워크</code>입니다. “ATT&#x26;CK”는 “Adversarial Tactics, Techniques, and Common Knowledge”의 약자로,공격자의 전술, 기술, 공통 지식을 다루고 이를 통해 보안 전문가와 조직은 공격자가 사용하는 다양한 전술과 기술을 이해하고, 그에 대응하는 <code class=\"language-text\">방어 전략을 수립</code>할 수 있습니다.<br></p>\n<p><strong>ATT&#x26;CK 프레임워크</strong>는 <code class=\"language-text\">전술(Tactics)</code>과 <code class=\"language-text\">기술(Techniques)</code>로 구성됩니다. 전술은 공격자가 공격을 수행하는 고수준의 목표를 의미하며, 기술은 실제로 사용되는 공격 기법과 방법을 설명합니다. 각 전술과 기술은 공격자의 행위를 카테고리화하고 문서화하여 보안 커뮤니티에 제공됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADiklEQVQ4y41UbUxbVRi+GmNqnMkSNftjdIkmRJMlxh+6bBpGJ2y0o3QICi0UJQpsgAtZMqBjQEuY0vXD7l7SdrRFR0fLvb3nnnPuPad37VC3+JEsW+b2A1FnIjFGnUuGSBBNSE17Wyj6x/ee3I9z3ue8532f570M2mqw+IIxJoRQStPpNIRQW4JFH20wuQ+IICzctAfCmBcE+8khk8nc09OVSqUKS6jgBCGUICwBFw0AoKqqfXCo0lD30u49DMM4RsdUNSVJ0v8CpzOZysoq3bbHjlqeadTf32GrIlQFEpDgFmNKN8sjpZSqerw+ne4hhmEefOC+toPMgfLneAHSFMUYFx1zIZmNPPO75Esly9WHzAzDWK1Noah4NWE80ahrsHTOzMzEYhewLJeCkVYJhBAAUjqdcZ1xP7vrhapq0+8rq9ls9ofFH/0s++iOJywt74iiiDaDwyIYQkopy00crrea6hp1D29/6ukyde7zu0srK2vrKH3l5XI9NxFIUVqSthZ5g0AIGy0tr7xqGveyH8Vmb87f/unOvd+WVniouJyDmbmPC9mhjWOXkA6xfClDpDh3Y37xr2z2ztLqz/dWb97+1cVORZxvJWPBLc6oBIwQFET6Rcrz51fmWGh4ekaS6UWCQYQbA57mNVRxNWAWRIrxvxSWH5IEMElH486Fi2XLl568FS77LvbiPLfrbnDnWmTH9+wjfrfeH4sQLEuFwxfliTACghS6HD31mavJY/NG9v5yeWd2bvv69LYb7OOj7z1vGK3ZPXx40O+UobxVJAjHE4lkQjwte3q/HnAsuFrBYEOgeSRUPsDtM3qaKjytNWPW8ZA7EZ8VAUiKIkJ4s9oI46mpD0eco+39R1rPH7UvOnq/HGoW+oyhzuqgpcHZ8uknV9b/Xp/l+YVvvkVYngyHZVnOgRVFCQSDxpra+rra1tfNNbXNtnC7jbSbuDf0DpPB/lpnb5frfde169eWl/+IxxM97x4LhyM5sKwoXp/fYDy0r2L/nr3l+gOG0+Nn3G5vx8nu+uNWW3db34k+n8/3gd8/POLo7x/o6u5huQmtZjnwgP3Um20dFfsPvt1+hOcFjPEsz0cno2e9Zzk/GzoXOj89raU2GQ4DAAilmzwTQoKhc9xEgBACIRRzvSeJkiiAJJ/kk6IowdyFECJ5eQKtsYtUQUKpoigg1+8QIvTff1NBC0WGtcl/APt23iQWmwkVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사진1\"\n        title=\"사진1\"\n        src=\"/static/04be1306bc101e5df67280573092fab4/01e7c/1.png\"\n        srcset=\"/static/04be1306bc101e5df67280573092fab4/e9ff0/1.png 180w,\n/static/04be1306bc101e5df67280573092fab4/f21e7/1.png 360w,\n/static/04be1306bc101e5df67280573092fab4/01e7c/1.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"-2-12개-tactics-전술br\" style=\"position:relative;\"><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\" aria-label=\" 2 12개 tactics 전술br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🟡 2. 12개 Tactics 전술<br></h2>\n<ul>\n<li><code class=\"language-text\">Initial Access</code>: 공격자가 시스템 또는 네트워크에 처음으로 접근하기 위해 사용하는 기법 전술</li>\n<li><code class=\"language-text\">Execution</code>: 공격자가 악성 코드 또는 악성 스크립트를 실행하여 시스템 내에서 명령을 실행하는 전술</li>\n<li><code class=\"language-text\">Persistence</code>: 공격자가 시스템에 대한 지속적인 액세스를 유지하기 위해 사용하는 기법을 포함한 전술입니다.</li>\n<li><code class=\"language-text\">Privilege Escalation</code>: 공격자가 권한 상승을 시도하여 시스템 내에서 더 높은 수준의 권한을 획득하는 전술입니다.</li>\n<li><code class=\"language-text\">Defense Evasion</code>: 공격자가 탐지 및 방어 기술을 피하고 자신의 활동을 감추는 기법을 사용하는 전술입니다.</li>\n<li><code class=\"language-text\">Credential Access</code>: 공격자가 인증 정보를 획득하여 시스템 또는 네트워크에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Discovery</code>: 공격자가 대상 시스템 및 네트워크를 조사하여 정보를 수집하는 전술입니다.</li>\n<li><code class=\"language-text\">Lateral Movement</code>: 공격자가 시스템 및 네트워크 내에서 이동하여 다른 시스템에 접근하는 전술입니다.</li>\n<li><code class=\"language-text\">Collection</code>: 공격자가 획득한 정보를 수집하고 추출하는 전술입니다.</li>\n<li><code class=\"language-text\">Exfiltration</code>: 공격자가 훔친 데이터를 시스템 또는 네트워크 외부로 전송하는 전술입니다.</li>\n<li><code class=\"language-text\">Command and Control</code>: 공격자가 원격 명령 및 제어 인프라를 구축하고 시스템과 통신하는 전술입니다.</li>\n<li><code class=\"language-text\">Impact</code>: 공격자가 시스템 또는 네트워크에 직접적인 피해를 입히는 전술입니다.</li>\n</ul>\n<hr>\n<h3 id=\"️-3-collection\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-collection\" aria-label=\"️ 3 collection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. Collection</h3>\n<p>T1560: Archive Collected Data</p>\n<blockquote>\n<p>공격자가 데이터를 압축하는 행동을 모니터링하는 것이 중요합니다. 대표적인 압축 도구인 tar에 대한 실행을 모니터링하는 규칙은 다음과 같습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">-w /bin/tar -p x -k archive_tool_execution</code></pre></div>\n<blockquote>\n<p>이 규칙은 tar 명령이 실행될 때마다 이를 감지하고 archive_tool_execution이라는 키로 이를 로깅합니다.</p>\n</blockquote>\n<p>T1123: Audio Capture</p>\n<blockquote>\n<p>이 기법은 오디오 데이터를 포착하려는 행동을 감지합니다. 그러나, 이러한 행동을 auditd를 사용하여 모니터링하는 것은 쉽지 않습니다. 이는 일반적으로 더 높은 수준의 애플리케이션 레벨 모니터링이 필요하며, 일반적인 Linux 배포판에서는 표준적인 auditd 구성으로는 이를 수행하기 어렵습니다.</p>\n</blockquote>\n<p>T1119: Automated Collection</p>\n<blockquote>\n<p>이 기법은 자동화된 스크립트나 도구를 사용해 정보를 수집하는 행동을 감지합니다. 이러한 행동을 감지하기 위해 cron 작업의 생성과 수정을 모니터링하는 규칙은 다음과 같습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> automated_collection\n<span class=\"token parameter variable\">-w</span> /var/spool/cron <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> automated_collection</code></pre></div>\n<p>T1115: Clipboard Data</p>\n<blockquote>\n<p>클립보드 데이터를 모니터링하는 것은 OS 레벨에서 감지하기 어려울 수 있습니다. 이는 더 높은 수준의 애플리케이션 레벨 모니터링이 필요하며, 일반적인 Linux 배포판에서는 표준적인 auditd 구성으로는 이를 수행하기 어렵습니다.</p>\n</blockquote>\n<p>T1213: Exploitation for Defense Evasion</p>\n<blockquote>\n<p>이 기법은 보안 메커니즘을 우회하기 위해 취약점을 악용하는 것을 포함합니다. 이는 감지하기 어려운 기법 중 하나이며, 공격자의 동작을 식별하기 위해서는 보안 커널 모듈이나 IDS/IPS 같은 다른 보안 도구를 활용하는 것이 더 효과적일 수 있습니다.</p>\n</blockquote>\n<p>T1005: Data from Local System</p>\n<blockquote>\n<p>이 기법은 공격자가 로컬 시스템에서 데이터를 수집하는 것을 포함합니다. find 명령을 감시하여 공격자가 시스템에서 데이터를 찾는 행동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/find <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> local_data_collection</code></pre></div>\n<p>T1039: Data from Network Shared Drive</p>\n<blockquote>\n<p>이 기법은 공격자가 네트워크 공유 드라이브에서 데이터를 수집하는 것을 포함합니다. mount 명령을 감시하여 공격자가 네트워크 공유를 마운트하는 행동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /bin/mount <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> shared_drive_access</code></pre></div>\n<p>T1025: Data from Removable Media</p>\n<blockquote>\n<p>이 기법은 공격자가 이동식 미디어에서 데이터를 수집하는 것을 포함합니다. USB 장치를 모니터링하여 이동식 미디어의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/sd* <span class=\"token parameter variable\">-p</span> rxa <span class=\"token parameter variable\">-k</span> removable_media</code></pre></div>\n<p>T1074: Data Staged</p>\n<blockquote>\n<p>이 기법은 공격자가 훔친 데이터를 한 곳에 모으는 것을 포함합니다. 임시 디렉토리를 모니터링하여 공격자가 데이터를 모으는 행동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /tmp/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> data_staging</code></pre></div>\n<p>T1114: Email Collection</p>\n<blockquote>\n<p>이 기법은 공격자가 이메일을 수집하는 것을 포함합니다. 이메일 관련 파일의 액세스를 모니터링하여 이메일 수집 행동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/mail/ <span class=\"token parameter variable\">-p</span> rxa <span class=\"token parameter variable\">-k</span> email_access\n<span class=\"token parameter variable\">-w</span> /var/spool/mail/ <span class=\"token parameter variable\">-p</span> rxa <span class=\"token parameter variable\">-k</span> email_access</code></pre></div>\n<p>T1113: Screen Capture</p>\n<blockquote>\n<p>이 기법은 공격자가 사용자의 스크린 캡처를 수집하는 것을 포함합니다. xwd, import와 같은 명령어를 감시하여 스크린 캡처 시도를 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/xwd <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> screen_capture\n<span class=\"token parameter variable\">-w</span> /usr/bin/import <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> screen_capture</code></pre></div>\n<p>T1125: Video Capture</p>\n<blockquote>\n<p>이 기법은 공격자가 비디오를 캡처하는 것을 포함합니다. ffmpeg, recordmydesktop와 같은 도구를 감시하여 비디오 캡처 시도를 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/ffmpeg <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> video_capture\n<span class=\"token parameter variable\">-w</span> /usr/bin/recordmydesktop <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> video_capture</code></pre></div>\n<h3 id=\"️-3-exfiltration\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-3-exfiltration\" aria-label=\"️ 3 exfiltration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 3. Exfiltration</h3>\n<p>T1071: Application Layer Protocol</p>\n<blockquote>\n<p>이 기법은 공격자가 응용 프로그램 계층 프로토콜을 이용하는 것을 포함합니다. SSH, FTP 같은 애플리케이션 계층 프로토콜의 사용을 감지하기 위해 이러한 서비스에 대한 실행을 모니터링할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/ssh <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> app_layer_protocol\n<span class=\"token parameter variable\">-w</span> /usr/bin/ftp <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> app_layer_protocol</code></pre></div>\n<p>T1092: Communication Through Removable Media</p>\n<blockquote>\n<p>이 기법은 공격자가 이동식 미디어를 통해 데이터를 전송하는 것을 포함합니다. USB 장치를 모니터링하여 이동식 미디어의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/sd* <span class=\"token parameter variable\">-p</span> rwa <span class=\"token parameter variable\">-k</span> removable_media</code></pre></div>\n<p>T1132: Data Encoding</p>\n<blockquote>\n<p>이 기법은 공격자가 데이터를 인코딩하는 것을 포함합니다. base64와 같은 인코딩 도구를 감시하여 데이터 인코딩 시도를 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/base64 <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> data_encoding</code></pre></div>\n<p>T1001: Data Obfuscation:</p>\n<blockquote>\n<p>이 기법은 공격자가 데이터를 난해하게 만드는 것을 포함합니다. base64와 같은 인코딩 도구를 감시하여 데이터 오브스케이션 시도를 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/base64 <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> data_obfuscation</code></pre></div>\n<p>T1568: Dynamic Resolution</p>\n<blockquote>\n<p>이 기법은 공격자가 도메인 생성 알고리즘(DGA)을 사용하는 것을 포함합니다. 보통 이는 네트워크 트래픽에서 감지되기 쉬우나, 많은 DNS 요청을 하는 도구에 대한 모니터링을 통해 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/dig <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> dynamic_resolution\n<span class=\"token parameter variable\">-w</span> /usr/bin/nslookup <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> dynamic_resolution</code></pre></div>\n<p>T1573: Encrypted Channel</p>\n<blockquote>\n<p>이 기법은 공격자가 암호화된 채널을 사용하는 것을 포함합니다. 이것은 일반적으로 네트워크 트래픽 분석을 통해 감지되지만, 암호화 도구의 사용을 감시하여 어느 정도 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/openssl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> encrypted_channel</code></pre></div>\n<p>T1008: Fallback Channels</p>\n<blockquote>\n<p>이 기법은 공격자가 통신이 차단되면 대체 채널로 전환하는 것을 포함합니다. 이것은 일반적으로 네트워크 트래픽 분석을 통해 감지되지만, 다양한 네트워크 도구의 사용을 모니터링하여 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/nc <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> fallback_channel\n<span class=\"token parameter variable\">-w</span> /usr/bin/curl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> fallback_channel</code></pre></div>\n<p>T1105: Remote File Copy</p>\n<blockquote>\n<p>이 기법은 공격자가 원격 파일 복사를 수행하는 것을 포함합니다. scp, sftp, wget, curl과 같은 파일 전송 도구를 감시하여 원격 파일 복사를 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/scp <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_file_copy\n<span class=\"token parameter variable\">-w</span> /usr/bin/sftp <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_file_copy\n<span class=\"token parameter variable\">-w</span> /usr/bin/wget <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_file_copy\n<span class=\"token parameter variable\">-w</span> /usr/bin/curl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_file_copy</code></pre></div>\n<p>T1104: Multi-Stage Channels</p>\n<blockquote>\n<p>이 기법은 공격자가 공격을 여러 단계로 나누어 통신하는 것을 포함합니다. 이 기법을 직접적으로 감지하는 것은 어렵습니다. 그러나, 여러 네트워킹 도구들의 사용을 감시함으로써 관련 활동을 일부 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/nc <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> multi_stage_channels\n<span class=\"token parameter variable\">-w</span> /usr/bin/curl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> multi_stage_channels</code></pre></div>\n<p>T1095: Non-Application Layer Protocol</p>\n<blockquote>\n<p>이 기법은 공격자가 애플리케이션 계층 프로토콜이 아닌 다른 프로토콜을 사용하는 것을 포함합니다. 이것은 일반적으로 네트워크 트래픽 분석을 통해 감지되지만, 특정 소켓 생성 도구의 사용을 감시함으로써 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/nc <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> non_application_layer_protocol</code></pre></div>\n<p>T1571: Non-Standard Port</p>\n<blockquote>\n<p>이 기법은 공격자가 표준이 아닌 포트를 사용하는 것을 포함합니다. 표준이 아닌 포트에서의 네트워크 활동은 일반적으로 네트워크 모니터링을 통해 감지되지만, 특정 네트워크 도구를 감시하여 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/nc <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> non_standard_port</code></pre></div>\n<p>T1572: Protocol Tunneling</p>\n<blockquote>\n<p>이 기법은 공격자가 프로토콜 터널링을 사용하는 것을 포함합니다. 이는 통상적으로 네트워크 트래픽 분석을 통해 감지되지만, 터널링 도구를 감시하여 어느 정도 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/ssh <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> protocol_tunneling</code></pre></div>\n<p>T1090: Proxy</p>\n<blockquote>\n<p>이 기법은 공격자가 네트워크 트래픽을 프록시 서버를 통해 전송하는 것을 포함합니다. 특정 프록시 도구의 사용을 감시하여 일부 활동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/proxychains <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> proxy\n<span class=\"token parameter variable\">-w</span> /usr/sbin/sshd <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> proxy</code></pre></div>\n<p>T1219: Remote Access Tools</p>\n<blockquote>\n<p>이 기법은 공격자가 원격 액세스 도구(RAT)를 사용하여 시스템에 액세스하는 것을 포함합니다. 이 기법을 직접적으로 감지하는 것은 어렵습니다. 그러나, RAT를 설치하거나 실행하는데 사용할 수 있는 다양한 시스템 유틸리티를 감시함으로써 관련 활동을 일부 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/nc <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_access_tools\n<span class=\"token parameter variable\">-w</span> /usr/bin/ssh <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_access_tools\n<span class=\"token parameter variable\">-w</span> /usr/sbin/sshd <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> remote_access_tools</code></pre></div>\n<p>T1102: Web Service</p>\n<blockquote>\n<p>이 기법은 공격자가 웹 서비스를 사용하여 정보를 전송하거나 C2 통신을 수행하는 것을 포함합니다. 이 기법을 감지하는 것은 어렵습니다. 그러나, 웹 서비스에 접근하는데 사용되는 명령어를 감시하여 일부 활동을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/curl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> web_service\n<span class=\"token parameter variable\">-w</span> /usr/bin/wget <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> web_service</code></pre></div>\n<h3 id=\"️-4-command-and-control\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-4-command-and-control\" aria-label=\"️ 4 command and control permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 4. Command and Control</h3>\n<p>T1020: Automated Exfiltration</p>\n<blockquote>\n<p>이 기법은 공격자가 자동화된 방법을 사용하여 데이터를 추출하는 것을 포함합니다. 이 기법을 감지하는 것은 매우 어려우며, 특정한 예제 auditd 규칙은 제공하기 어렵습니다. 그러나 네트워크 트래픽 모니터링, 이상 징후 탐지 등을 통해 감지를 시도할 수 있습니다.</p>\n</blockquote>\n<p>T1030: Data Transfer Size Limits</p>\n<blockquote>\n<p>공격자가 데이터 추출량을 제한하는 것을 포함합니다. 이를 감지하는 것은 매우 어렵고, 이 기법을 감지하기 위한 특정 auditd 규칙을 제시하는 것은 불가능합니다.</p>\n</blockquote>\n<p>T1048: Exfiltration Over Alternative Protocol</p>\n<blockquote>\n<p>이 기법은 공격자가 표준 프로토콜 이외의 것을 사용하여 데이터를 추출하는 것을 포함합니다. 이 기법을 직접 감지하는 것은 어렵지만, 네트워크 트래픽 분석을 통해 이상한 트래픽을 감지하는 것이 가능할 수 있습니다.</p>\n</blockquote>\n<p>T1041: Exfiltration Over Command and Control Channel</p>\n<blockquote>\n<p>이 기법은 공격자가 명령 및 제어 채널을 통해 데이터를 추출하는 것을 포함합니다. 이 기법을 직접 감지하는 것은 어렵지만, C2 통신을 감지하거나 분석하는데 사용되는 도구나 방법을 이용하여 감지가 가능할 수 있습니다.</p>\n</blockquote>\n<p>T1011: Exfiltration Over Other Network Medium</p>\n<blockquote>\n<p>이 기법은 공격자가 TCP/IP 네트워크 외의 다른 네트워크 매체를 통해 데이터를 추출하는 것을 포함합니다. 이 기법을 직접적으로 감지하는 것은 어렵습니다.</p>\n</blockquote>\n<p>T1052: Exfiltration Over Physical Medium</p>\n<blockquote>\n<p>이 기법은 공격자가 물리적 매체(예: USB 드라이브)를 통해 데이터를 추출하는 것을 포함합니다. USB 장치의 사용을 추적하려면 다음과 같은 auditd 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /dev/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> usb\n<span class=\"token parameter variable\">-w</span> /media/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> usb\n<span class=\"token parameter variable\">-w</span> /mnt/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> usb</code></pre></div>\n<p>T1567: Exfiltration Over Web Service</p>\n<blockquote>\n<p>이 기법은 공격자가 웹 서비스를 이용해 데이터를 추출하는 것을 포함합니다. 이 기법을 감지하기 위한 특정 auditd 규칙을 제공하기는 어렵습니다. 대신에, HTTP 트래픽을 모니터링하거나 알려진 악성 도메인에 대한 접근을 탐지하는 방법을 사용해야 할 수 있습니다.</p>\n</blockquote>\n<p>T1029: Scheduled Transfer</p>\n<blockquote>\n<p>이 기법은 공격자가 데이터 전송을 스케줄링하는 것을 포함합니다. 이 기법은 특정한 스케줄링 도구를 사용하기 때문에, 그 도구의 사용을 모니터링하는 것으로 감지를 시도할 수 있습니다. 예를 들어, cron을 모니터링하기 위한 규칙은 다음과 같습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /etc/crontab <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span>\n<span class=\"token parameter variable\">-w</span> /etc/cron.*/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> <span class=\"token function\">cron</span></code></pre></div>\n<h3 id=\"️-5-impact\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-5-impact\" aria-label=\"️ 5 impact permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⌨️ 5. Impact</h3>\n<p>T1531: Account Access Removal: 이 기법은 공격자가 사용자 계정에 대한 액세스를 제거하는 것을 포함합니다. 이를 감지하기 위한 auditd 규칙은 다음과 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/userdel <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> account_deletion\n<span class=\"token parameter variable\">-w</span> /usr/sbin/deluser <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> account_deletion\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b64 <span class=\"token parameter variable\">-S</span> setreuid <span class=\"token parameter variable\">-k</span> setreuid\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">arch</span><span class=\"token operator\">=</span>b32 <span class=\"token parameter variable\">-S</span> setreuid <span class=\"token parameter variable\">-k</span> setreuid</code></pre></div>\n<p>T1485: Data Destruction</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템에서 데이터를 파괴하는 것을 포함합니다. 파일을 삭제하는 rm 명령을 감지하는 auditd 규칙은 다음과 같습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> exit,always <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/bin/rm <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-F</span> auid<span class=\"token operator\">>=</span><span class=\"token number\">1000</span> <span class=\"token parameter variable\">-k</span> delete</code></pre></div>\n<p>T1486: Data Encrypted for Impact</p>\n<blockquote>\n<p>이 기법은 공격자가 악성 소프트웨어(예: 랜섬웨어)를 사용하여 시스템 데이터를 암호화하는 것을 포함합니다. 일반적으로 auditd는 암호화된 파일의 내용을 직접 탐지할 수 없지만, 특정 암호화 도구가 사용되었다면, 이 도구에 대한 system call을 모니터링할 수 있습니다. 예를 들어, openssl 도구 사용을 모니터링하려면 다음과 같은 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/bin/openssl <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> openssl_use</code></pre></div>\n<p>T1565: Data Manipulation</p>\n<blockquote>\n<p>이 기법은 공격자가 데이터 무결성을 손상시키기 위해 시스템 데이터를 조작하는 것을 포함합니다. 이를 감지하기 위한 특정한 auditd 규칙은 없습니다. 그러나 파일 변경을 모니터링하거나 알려진 데이터 조작 도구의 사용을 모니터링하는 것이 도움이 될 수 있습니다.</p>\n</blockquote>\n<p>T1491: Defacement</p>\n<blockquote>\n<p>이 기법은 공격자가 웹사이트의 보이는 내용을 변경하는 것을 포함합니다. 이 기법을 감지하기 위한 auditd 규칙은 웹 서버의 HTML 파일에 대한 변경을 모니터링하는 것일 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /var/www/ <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> web_defacement</code></pre></div>\n<p>T1561: Disk Content Wipe</p>\n<blockquote>\n<p>이 기법은 공격자가 디스크의 내용을 삭제하는 것을 포함합니다. 이를 감지하기 위한 auditd 규칙은 디스크 삭제 도구에 대한 system call을 모니터링하는 것일 수 있습니다. 예를 들어, dd 도구 사용을 모니터링하려면 다음과 같은 규칙을 사용할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /bin/dd <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> disk_wipe</code></pre></div>\n<p>T1499: Endpoint Denial of Service</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템의 가용성을 저해하는 것을 포함합니다. 이 기법을 감지하기 위한 auditd 규칙은 특정 자원에 대한 접근 빈도를 모니터링하는 것일 수 있습니다. 그러나, 이러한 유형의 공격은 보통 네트워크 레벨에서 감지되므로, IDS/IPS 시스템이 더 효과적일 수 있습니다.</p>\n</blockquote>\n<p>T1495: Firmware Corruption</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템의 펌웨어를 손상시키는 것을 포함합니다. 펌웨어 수정은 특수한 권한을 필요로 하기 때문에, 관련된 유틸리티에 대한 실행을 감지하는 것이 가능하다. 예를 들어, flashrom이라는 펌웨어 플래싱 도구에 대한 사용을 모니터링할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /usr/sbin/flashrom <span class=\"token parameter variable\">-p</span> x <span class=\"token parameter variable\">-k</span> firmware_modification</code></pre></div>\n<p>T1490: Inhibit System Recovery</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 복구 절차를 방해하는 것을 포함합니다. 예를 들어, 공격자는 시스템 백업을 삭제하거나 변경할 수 있습니다. 따라서, 백업 관련 파일이나 프로세스에 대한 변경을 모니터링하면 이 기법을 감지하는 데 도움이 될 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-w</span> /path/to/backup <span class=\"token parameter variable\">-p</span> wa <span class=\"token parameter variable\">-k</span> backup_modification</code></pre></div>\n<p>T1498: Network Denial of Service</p>\n<blockquote>\n<p>이 기법은 공격자가 네트워크 자원의 가용성을 저해하는 것을 포함합니다. 그러나 이러한 공격은 일반적으로 네트워크 레벨에서 감지되므로, IDS/IPS 시스템 등이 더 효과적일 수 있습니다. auditd는 이러한 유형의 공격을 직접 탐지하는데 유용하지 않을 수 있습니다.</p>\n</blockquote>\n<p>T1496: Resource Hijacking</p>\n<blockquote>\n<p>이 기법은 공격자가 컴퓨팅 리소스를 무단으로 사용하는 것을 포함합니다. 이는 보통 크립토커런시 마이닝과 같은 작업을 위해 사용됩니다. auditd를 사용해 특정 마이닝 도구의 사용을 모니터링할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">-w /path/to/mining/tool -p x -k resource_hijacking</code></pre></div>\n<p>T1489: Service Stop</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템 서비스를 중지시키는 것을 포함합니다. 서비스 중지는 일반적으로 systemctl이나 service 명령어를 통해 수행되므로, 이 명령어들의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/service <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> service_stop\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/bin/systemctl <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> service_stop</code></pre></div>\n<p>T1529: System Shutdown/Reboot</p>\n<blockquote>\n<p>이 기법은 공격자가 시스템을 종료하거나 재부팅하는 것을 포함합니다. shutdown, reboot, poweroff 등의 명령어가 사용되므로, 이 명령어들의 사용을 감지할 수 있습니다:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/shutdown <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> system_shutdown_reboot\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/reboot <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> system_shutdown_reboot\n<span class=\"token parameter variable\">-a</span> always,exit <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">path</span><span class=\"token operator\">=</span>/usr/sbin/poweroff <span class=\"token parameter variable\">-F</span> <span class=\"token assign-left variable\">perm</span><span class=\"token operator\">=</span>x <span class=\"token parameter variable\">-k</span> system_shutdown_reboot</code></pre></div>\n<hr>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<blockquote>\n<p><a href=\"https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22\">https://www.devseccon.com/blog/3-reasons-to-use-ssh-certificates-instead-of-ssh-keys-secadvent-day-22</a><br>\n<a href=\"https://blog.naver.com/alice_k106/221803861645\">https://blog.naver.com/alice_k106/221803861645</a></p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EC%86%8C%EA%B0%9C\">👋 소개</a></p>\n<ul>\n<li><a href=\"#-1-attck%EB%9E%80-br\">🔴 1. ATT&#x26;CK란 <br></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-2-12%EA%B0%9C-tactics-%EC%A0%84%EC%88%A0br\">🟡 2. 12개 Tactics 전술<br></a></p>\n<ul>\n<li><a href=\"#%EF%B8%8F-3-collection\">⌨️ 3. Collection</a></li>\n<li><a href=\"#%EF%B8%8F-3-exfiltration\">⌨️ 3. Exfiltration</a></li>\n<li><a href=\"#%EF%B8%8F-4-command-and-control\">⌨️ 4. Command and Control</a></li>\n<li><a href=\"#%EF%B8%8F-5-impact\">⌨️ 5. Impact</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 16, 2023","title":"[보안]  ATT&CK - Linux 공격기법 정리 (4)","categories":"보안","author":"sb","emoji":"🔐"},"fields":{"slug":"/5-security-mitre-4/"}},"site":{"siteMetadata":{"siteUrl":"https://sbbb.me","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/5-security-mitre-3/","nextSlug":"/5-security-mitre-2/","prevSlug":"/5-security-mitre-4/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}